<!DOCTYPE html>
<html lang="">
    <!-- title -->




<!-- keywords -->




<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="author" content="骑麦兜看落日">
    <meta name="renderer" content="webkit">
    <meta name="copyright" content="骑麦兜看落日">
    
    <meta name="keywords" content="骑麦兜看落日,骑麦兜看落日">
    
    <meta name="description" content>
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>[Code]Python学习手册_第五部分_模块 · 骑麦兜看落日&#39;s Blog</title>
    <style type="text/css">
    @font-face {
        font-family: 'Oswald-Regular';
        src: url("/font/Oswald-Regular.ttf");
    }

    body {
        margin: 0;
    }

    header,
    footer,
    .back-top,
    .sidebar,
    .container,
    .site-intro-meta,
    .toc-wrapper {
        display: none;
    }

    .site-intro {
        position: relative;
        z-index: 3;
        width: 100%;
        /* height: 50vh; */
        overflow: hidden;
    }

    .site-intro-placeholder {
        position: absolute;
        z-index: -2;
        top: 0;
        left: 0;
        width: calc(100% + 300px);
        height: 100%;
        background: repeating-linear-gradient(-45deg, #444 0, #444 80px, #333 80px, #333 160px);
        background-position: center center;
        transform: translate3d(-226px, 0, 0);
        animation: gradient-move 2.5s ease-out 0s infinite;
    }

    @keyframes gradient-move {
        0% {
            transform: translate3d(-226px, 0, 0);
        }
        100% {
            transform: translate3d(0, 0, 0);
        }
    }

</style>

    <link rel="preload" href="/css/style.css?v=20180824" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="stylesheet" href="/css/mobile.css?v=20180824" media="(max-width: 980px)">
    
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    
    <!-- /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
/* This file is meant as a standalone workflow for
- testing support for link[rel=preload]
- enabling async CSS loading in browsers that do not support rel=preload
- applying rel preload css once loaded, whether supported or not.
*/ -->
<script>
(function( w ){
	"use strict";
	// rel=preload support test
	if( !w.loadCSS ){
		w.loadCSS = function(){};
	}
	// define on the loadCSS obj
	var rp = loadCSS.relpreload = {};
	// rel=preload feature support test
	// runs once and returns a function for compat purposes
	rp.support = (function(){
		var ret;
		try {
			ret = w.document.createElement( "link" ).relList.supports( "preload" );
		} catch (e) {
			ret = false;
		}
		return function(){
			return ret;
		};
	})();

	// if preload isn't supported, get an asynchronous load by using a non-matching media attribute
	// then change that media back to its intended value on load
	rp.bindMediaToggle = function( link ){
		// remember existing media attr for ultimate state, or default to 'all'
		var finalMedia = link.media || "all";

		function enableStylesheet(){
			link.media = finalMedia;
		}

		// bind load handlers to enable media
		if( link.addEventListener ){
			link.addEventListener( "load", enableStylesheet );
		} else if( link.attachEvent ){
			link.attachEvent( "onload", enableStylesheet );
		}

		// Set rel and non-applicable media type to start an async request
		// note: timeout allows this to happen async to let rendering continue in IE
		setTimeout(function(){
			link.rel = "stylesheet";
			link.media = "only x";
		});
		// also enable media after 3 seconds,
		// which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
		setTimeout( enableStylesheet, 3000 );
	};

	// loop through link elements in DOM
	rp.poly = function(){
		// double check this to prevent external calls from running
		if( rp.support() ){
			return;
		}
		var links = w.document.getElementsByTagName( "link" );
		for( var i = 0; i < links.length; i++ ){
			var link = links[ i ];
			// qualify links to those with rel=preload and as=style attrs
			if( link.rel === "preload" && link.getAttribute( "as" ) === "style" && !link.getAttribute( "data-loadcss" ) ){
				// prevent rerunning on link
				link.setAttribute( "data-loadcss", true );
				// bind listeners to toggle media back
				rp.bindMediaToggle( link );
			}
		}
	};

	// if unsupported, run the polyfill
	if( !rp.support() ){
		// run once at least
		rp.poly();

		// rerun poly on an interval until onload
		var run = w.setInterval( rp.poly, 500 );
		if( w.addEventListener ){
			w.addEventListener( "load", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		} else if( w.attachEvent ){
			w.attachEvent( "onload", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		}
	}


	// commonjs
	if( typeof exports !== "undefined" ){
		exports.loadCSS = loadCSS;
	}
	else {
		w.loadCSS = loadCSS;
	}
}( typeof global !== "undefined" ? global : this ) );
</script>

    <link rel="icon" href="/assets/favicon.ico">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js" as="script">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" as="script">
    <link rel="preload" href="/scripts/main.js" as="script">
    <link rel="preload" as="font" href="/font/Oswald-Regular.ttf" crossorigin>
    <link rel="preload" as="font" href="https://at.alicdn.com/t/font_327081_1dta1rlogw17zaor.woff" crossorigin>
    
        <!-- algolia -->
        <script>
            
            var hits = JSON.parse('{"per_page":10}')
            var labels = JSON.parse('{"input_placeholder":"Search for Posts","hits_empty":"We did not find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}')

            var algolia = {
                applicationID: '5D5KDIMZEQ',
                apiKey: 'b4ec67c101aa9269e65e640e2e469343',
                indexName: 'my_index',
                hits: hits,
                labels: labels
            }
        </script>
    
    <!-- fancybox -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" defer></script>
    <!-- 百度统计  -->
    
    <!-- 谷歌统计  -->
    
</head>

    
        <body class="post-body">
    
    
<header class="header">

    <div class="read-progress"></div>
    <div class="header-sidebar-menu">&#xe775;</div>
    <!-- post页的toggle banner  -->
    
    <div class="banner">
            <div class="blog-title">
                <a href="/" >骑麦兜看落日</a>
            </div>
            <div class="post-title">
                <a href="#" class="post-name">[Code]Python学习手册_第五部分_模块</a>
            </div>
    </div>
    
    <a class="home-link" href=/>骑麦兜看落日</a>
</header>
    <div class="wrapper">
        <div class="site-intro" style="







height:30vh;
">
    
    <!-- 主页  -->
    
    
    <!-- 404页  -->
            
    <div class="site-intro-placeholder"></div>
    <div class="site-intro-img" style="background-image: url(/intro/post-bg.jpg)"></div>
    <div class="site-intro-meta">
        <!-- 标题  -->
        <h1 class="intro-title">
            <!-- 主页  -->
            
            [Code]Python学习手册_第五部分_模块
            <!-- 404 -->
            
        </h1>
        <!-- 副标题 -->
        <p class="intro-subtitle">
            <!-- 主页副标题  -->
            
            
            <!-- 404 -->
            
        </p>
        <!-- 文章页meta -->
        
            <div class="post-intros">
                <!-- 文章页标签  -->
                
                    <div class= post-intro-tags >
    
        <a class="post-tag" href="javascript:void(0);" data-tags = "Note">Note</a>
    
        <a class="post-tag" href="javascript:void(0);" data-tags = "Code">Code</a>
    
        <a class="post-tag" href="javascript:void(0);" data-tags = "Python">Python</a>
    
</div>
                
                
                    <div class="post-intro-read">
                        <span>字数统计: <span class="post-count word-count">17k</span>阅读时长: <span class="post-count reading-time">68 min</span></span>
                    </div>
                
                <div class="post-intro-meta">
                    <span class="post-intro-calander iconfont-archer">&#xe676;</span>
                    <span class="post-intro-time">2018/08/10</span>
                    
                    <span id="busuanzi_container_page_pv" class="busuanzi-pv">
                        <span class="iconfont-archer">&#xe602;</span>
                        <span id="busuanzi_value_page_pv"></span>
                    </span>
                    
                    <span class="shareWrapper">
                        <span class="iconfont-archer shareIcon">&#xe71d;</span>
                        <span class="shareText">Share</span>
                        <ul class="shareList">
                            <li class="iconfont-archer share-qr" data-type="qr">&#xe75b;
                                <div class="share-qrcode"></div>
                            </li>
                            <li class="iconfont-archer" data-type="weibo">&#xe619;</li>
                            <li class="iconfont-archer" data-type="qzone">&#xe62e;</li>
                            <li class="iconfont-archer" data-type="twitter">&#xe634;</li>
                            <li class="iconfont-archer" data-type="facebook">&#xe67a;</li>
                        </ul>
                    </span>
                </div>
            </div>
        
    </div>
</div>
        <script>
 
  // get user agent
  var browser = {
    versions: function () {
      var u = window.navigator.userAgent;
      return {
        userAgent: u,
        trident: u.indexOf('Trident') > -1, //IE内核
        presto: u.indexOf('Presto') > -1, //opera内核
        webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
        gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
        mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
        ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
        android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或者uc浏览器
        iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //是否为iPhone或者安卓QQ浏览器
        iPad: u.indexOf('iPad') > -1, //是否为iPad
        webApp: u.indexOf('Safari') == -1, //是否为web应用程序，没有头部与底部
        weixin: u.indexOf('MicroMessenger') == -1, //是否为微信浏览器
        uc: u.indexOf('UCBrowser') > -1 //是否为android下的UC浏览器
      };
    }()
  }
  console.log("userAgent:" + browser.versions.userAgent);

  // callback
  function fontLoaded() {
    console.log('font loaded');
    if (document.getElementsByClassName('site-intro-meta')) {
      document.getElementsByClassName('intro-title')[0].classList.add('intro-fade-in');
      document.getElementsByClassName('intro-subtitle')[0].classList.add('intro-fade-in');
      var postIntros = document.getElementsByClassName('post-intros')[0]
      if (postIntros) {
        postIntros.classList.add('post-fade-in');
      }
    }
  }

  // UC不支持跨域，所以直接显示
  function asyncCb(){
    if (browser.versions.uc) {
      console.log("UCBrowser");
      fontLoaded();
    } else {
      WebFont.load({
        custom: {
          families: ['Oswald-Regular']
        },
        loading: function () {  //所有字体开始加载
          // console.log('loading');
        },
        active: function () {  //所有字体已渲染
          fontLoaded();
        },
        inactive: function () { //字体预加载失败，无效字体或浏览器不支持加载
          console.log('inactive: timeout');
          fontLoaded();
        },
        timeout: 5000 // Set the timeout to two seconds
      });
    }
  }

  function asyncErr(){
    console.warn('script load from CDN failed, will load local script')
  }

  // load webfont-loader async, and add callback function
  function async(u, cb, err) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (cb) { o.addEventListener('load', function (e) { cb(null, e); }, false); }
    if (err) { o.addEventListener('error', function (e) { err(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }

  var asyncLoadWithFallBack = function(arr, success, reject) {
      var currReject = function(){
        reject()
        arr.shift()
        if(arr.length)
          async(arr[0], success, currReject)
        }

      async(arr[0], success, currReject)
  }

  asyncLoadWithFallBack([
    "https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js", 
    "https://cdn.bootcss.com/webfont/1.6.28/webfontloader.js",
    "/lib/webfontloader.min.js"
  ], asyncCb, asyncErr)
</script>        
        <img class="loading" src="/assets/loading.svg" style="display: block; margin: 6rem auto 0 auto; width: 6rem; height: 6rem;" />
        <div class="container container-unloaded">
            <main class="main post-page">
    <article class="article-entry">
        <h1 id="第二十一章-模块-宏伟蓝图"><a href="#第二十一章-模块-宏伟蓝图" class="headerlink" title="第二十一章 模块:宏伟蓝图"></a>第二十一章 模块:宏伟蓝图</h1><blockquote>
<ul>
<li>深入学习Python模块</li>
<li>介绍模块、属性以及导入的基础知识</li>
<li>探索<code>import</code>语句的操作</li>
<li>学到导入模块搜索路径与配置搜索路径</li>
<li>介绍命名空间的概念</li>
</ul>
</blockquote>
<hr>
<h2 id="为什么使用模块"><a href="#为什么使用模块" class="headerlink" title="为什么使用模块"></a>为什么使用模块</h2><blockquote>
<ul>
<li><p>代码重用</p>
<p>模块可以在文件中永久保存代码,可以按照需要任意次数地重新载入和重新运行模块</p>
<p>模块是封装变量名的命名空间,模块文件顶层定义的所有变量名被认作是导入模块的对象属性,可以被多个外部的客户端引用</p>
<p>模块允许将独立的文件连接成一个更大的程序系统</p>
</li>
<li><p>系统命名空间的划分</p>
<p>模块是Python中最高级别的程序组织单元</p>
<p>模块通过封装自包含的变量的软件包,即命名空间提供了将部件组织为系统的简单方法,这一点对避免变量名的冲突很有帮助,如果不精确导人文件的话,就无法看到另一个文件中的变量名</p>
<p>模块文件的全局作用域成为模块对象的命名空间</p>
</li>
<li><p>实现共享服务和数据</p>
<p>从操作的角度来看,模块对实现跨系统共享的组件是很方便的,而且只需要一个拷贝即可</p>
<p>一个模块中的全局对象可以背一个以上的函数或文件使用</p>
</li>
</ul>
</blockquote>
<hr>
<h2 id="Python程序架构"><a href="#Python程序架构" class="headerlink" title="Python程序架构"></a>Python程序架构</h2><p>Python程序的架构是将一个程序分割为源代码文件的集合以及将这些部分连接在一起的方法</p>
<h3 id="如何组织一个程序"><a href="#如何组织一个程序" class="headerlink" title="如何组织一个程序"></a>如何组织一个程序</h3><p>程序是作为一个主体的、顶层的文件配合有零个或多个支持的文件来构造的,这些文件称作模块</p>
<p>在Python中,顶层文件包含了程序的主要的控制流程,模块文件就是工具的库,这些工具提供顶层文件或其他地方使用的组件</p>
<p>模块文件通常在运行时不需要直接做任何事,可以导入模块来获取或使用模块定义的工具,即模块的属性</p>
<h3 id="导入和属性"><a href="#导入和属性" class="headerlink" title="导入和属性"></a>导入和属性</h3><p>模块是最高级别的组织结构,也是Python中程序代码重用的最高层次,模块中编写的组件可以让其他程序使用</p>
<p>任何文件都能从任何其他文件中导入其工具,导入链要多深就有多深</p>
<p><code>import</code>语句可以在运行时载入其他文件,给顶层文件提供了模块文件全局作用域所有对象的访问权限</p>
<p><code>import</code><strong>执行时</strong>解析模块文件,创建模块对象及对象中的语句并将模块对象赋值给模块名</p>
<p>适用对象属性语法<code>object.attribute</code>可以调用对象的属性的值,有些属性是可调用的对象,有些对象是数据数值</p>
<h3 id="标准库模块"><a href="#标准库模块" class="headerlink" title="标准库模块"></a>标准库模块</h3><p>Python自带的模块集合称为标准链接库,大约有200个模块,包含与平台不相关的常见程序设计任务:操作系统接口、对象永久保存、文字模式匹配、网络和Internet脚本、GUI建构等,这些工具不是Python语言的组成部分,但是可以在任何安装了标准Python的情况下导入适当的模块使用</p>
<p>可以通过Python标准库参考手册查看整体的标准库模块</p>
<hr>
<h2 id="import如何工作"><a href="#import如何工作" class="headerlink" title="import如何工作"></a>import如何工作</h2><p>Python把载入的模块存储到名为<code>sys.modules</code>的表中,并在导入操作的开始检查该表,如果模块不存在,将会启动一个三个步骤的过程</p>
<p>导入是<strong>运行时</strong>的运算,<strong>第一次导入</strong>指定文件时执行三个步骤</p>
<blockquote>
<ol>
<li>找到模块文件</li>
<li>编译成位码(需要时)</li>
<li>执行模块的代码来创建其所定义的对象</li>
</ol>
</blockquote>
<p>若不是第一次导入会跳过这三个步骤,提取内存中已加载的模块对象</p>
<p>通过调用<code>reload</code>可以强制重新导入</p>
<h3 id="搜索"><a href="#搜索" class="headerlink" title="搜索"></a>搜索</h3><p>首先,Python必须查找到<code>import</code>语句所引用的模块文件</p>
<p>Python使用标准模块搜索路径来找出<code>import</code>语句所对应的模块文件,所以模块名应省略路径和后缀</p>
<h3 id="编译-可选"><a href="#编译-可选" class="headerlink" title="编译(可选)"></a>编译(可选)</h3><p>必要时,Python会将符合<code>import</code>语句的源代码文件编译为字节码</p>
<p>Python会检查文件的时间戳,当已存在的字节码文件比源代码文件旧时会在程序运行时自动重新生成字节代码,否则会跳过源代码到字节码的编译步骤</p>
<p>Python在搜索路径上只发现字节码文件时会直接加载字节码文件</p>
<p>只有<strong>被导入</strong>的文件才会编译生成<code>.pyc</code>文件,顶层文件通常直接执行,其字节码在内部使用后被丢弃所以没有<code>.pyc</code>文件</p>
<h3 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h3><p><code>import</code>操作的最后步骤是执行模块的字节码,模块文件中顶层代码做的实际工作会在导入时看到其结果</p>
<p>文件中所有语句依次执行,对变量名的赋值运算都会产生模块文件的属性,生成模块代码定义的所有工具</p>
<hr>
<h2 id="模块搜索路径"><a href="#模块搜索路径" class="headerlink" title="模块搜索路径"></a>模块搜索路径</h2><p>导入过程最重要及最早的部分是定位要导入的文件,定位依赖<strong>模块导入搜索路径</strong>的自动特性或手动配置</p>
<p>Python的模块搜索路径是主要组件组合的结果,其中第一和第三进行了预先定义,第二和第四可以进行拓展路径,Python将收集它所找到的所有路径文件中的目录名,并且过滤掉任何重复的和不存在的目录</p>
<blockquote>
<ol>
<li><p>程序的主目录</p>
<p>Python首先会在主目录内搜索导入的文件</p>
<p>这个入口是包含所运行的程序的顶层脚本文件的目录,交互模式下,这一入口是当前工作的目录</p>
<p>因为这个目录总是先被搜索,如果程序完全位于单一目录,所有导入自动工作,而并不需要配置路径</p>
<p>由于这个目录是先搜索的,其文件将覆盖路径上的其他目录中具有同样名称的模块,可能会意外隐藏库模块</p>
</li>
<li><p><code>PYTHONPATH</code>目录</p>
<p>之后，Python会从左至右搜索<code>PYTHONPATH</code>环境变量设置中罗列出的所有目录</p>
<p><code>PYTHONPATH</code>是设置包含Python程序文件的目录的列表,可以添加想导入的目录来扩展模块搜索的路径</p>
<p>Python会先搜索主目录,当导人的文件跨目录时,这个设置才显得格外重要</p>
</li>
<li><p>标准链接库目录</p>
<p>接着,Python会自动搜索标准库模块的安装目录</p>
<p>因为这些一定会被搜索,通常是不需要添加到PYTHONPATH之中或包含到路径文件中的</p>
</li>
<li><p>任何<code>.pth</code>文件的内容</p>
<p>最后，Python允许用户把有效的目录添加到<code>.pth</code>后缀的文本文件中</p>
<p>将<code>.pth</code>文件放在Python安装目录的顶层或者在标准库所在位置的<code>sitepackages</code>子目录中扩展模块搜索路径</p>
<p>某些用户文本文件可能比环境设置更容易编码</p>
<p>路径文件作为第三方库经常使用,它通常在Python的<code>site-packages</code>目录安装一个路径文件,从而不需要用户设置</p>
</li>
</ol>
</blockquote>
<h3 id="配置搜索路径"><a href="#配置搜索路径" class="headerlink" title="配置搜索路径"></a>配置搜索路径</h3><p>搜索路径的<code>PYTHONPATH</code>和路径文件允许我们调整模块导入搜索路径</p>
<p>设置环境变量方法与存储路径文件位置随平台的变化而变化</p>
<h3 id="搜索路径的变动"><a href="#搜索路径的变动" class="headerlink" title="搜索路径的变动"></a>搜索路径的变动</h3><p>搜索路径的配置随平台及Python版本而异,附加的目录可能自动加入模块搜索路径</p>
<p>可以通过<code>sys.path</code>查看平台上配置的模块搜索路径</p>
<h3 id="sys-path"><a href="#sys-path" class="headerlink" title="sys.path"></a>sys.path</h3><p>通过打印内置的<code>sys.path</code>列表查看模块搜索路径的实际配置,打印的<strong>目录名称字符串列表</strong>就是Python内部实际搜索路径,Python由左至右搜索这个列表中的每个目录</p>
<p>Python在程序启动时将顶级文件的主目录、任何PYTHONPATH目录、已经创建的任何<code>.pth</code>文件路径及标准库目录合并,在导入时直接查找目录名的字符串列表</p>
<p>目录名的字符串列表提供了确认搜索路径是否成功配置的方法</p>
<p>目录名的字符串列表提供了通过修改<code>sys.path</code>使脚本暂时调整搜索路径的方式</p>
<h3 id="模块文件选择"><a href="#模块文件选择" class="headerlink" title="模块文件选择"></a>模块文件选择</h3><p><code>import</code>语句省略文件名的后缀,Python选择在搜索路径中第一个符合导入文件名的文件</p>
<p>符合导入的后缀名</p>
<blockquote>
<ul>
<li>源代码文件<code>.py</code></li>
<li>字节码文件<code>.pyc</code></li>
<li>目录、包的导入</li>
<li>编译拓展模块(C或C++编写),动态链接(<code>.so</code>、<code>.dll</code>、<code>.pyd</code>)</li>
<li>C编写的编译好的内置模块通过静态链接至Python</li>
<li>ZIP文件组件,导入时自动解压缩</li>
<li><code>frozen</code>可执行文件的内存内映像</li>
<li>Jython版本的Java类</li>
<li>IronPython版本的.NET组件</li>
</ul>
</blockquote>
<p>对于不同后缀名的同名文件,在不同目录中时按照由左至右的顺序加载<code>sys.path</code>中目录先出现的文件,在相同目录中时遵循标准挑选顺序,挑选顺序可能有所变化</p>
<h3 id="高级的模块选择概念"><a href="#高级的模块选择概念" class="headerlink" title="高级的模块选择概念"></a>高级的模块选择概念</h3><p>导入钩子(import hook)可以重新定义<code>import</code>操作,<code>__import__</code>函数可用于定制<code>import</code>语句</p>
<p> 通过在创建和执行时加入<code>-O</code>输出<code>.pyo</code>文件,比普通的<code>.pyc</code>文件快</p>
<h3 id="第三方工具-distutils"><a href="#第三方工具-distutils" class="headerlink" title="第三方工具:distutils"></a>第三方工具:distutils</h3><p>Python的第三方拓展通常使用标准链接库中的<code>distutils</code>工具自动安装,不需要设置路径</p>
<p>使用<code>distutils</code>的系统一般都附带<code>setup.py</code>脚本进行程序的安装,这个脚本会导入并使用<code>distutils</code>模块将系统放在属于模块自动搜索路径一部分的目录内(通常在<code>Lib/site-packages</code>)</p>
<hr>
<h2 id="本章习题"><a href="#本章习题" class="headerlink" title="本章习题"></a>本章习题</h2><ol>
<li><p>模块源代码文件是怎样变成模块对象的</p>
<blockquote>
<p>模块的源代码文件在模块导人时,就会自动生成模块对象</p>
<p>从技术角度来讲,模块的源代码会在导入时运行,一次一条语句,而在这个过程中赋值的所有变量名都会生成模块对象的属性</p>
</blockquote>
</li>
<li><p>为什么需要设置<code>PYTHONPATH</code>环境变量</p>
<blockquote>
<p>设置<code>PYTHONPATH</code>可以从正在用的目录(交互模式下的当前目录,或者包含顶层文件的目录)以外的其他目录进行导人</p>
</blockquote>
</li>
<li><p>举出模块导人搜索路径的四个主要组件</p>
<blockquote>
<p>模块导入搜索路径的四个主要组件是顶层脚本的主目录、列在<code>PYTHONPATH</code>环境变量中的所有目录、标准链接库目录以及位于标准位置中<code>.pth</code>路径文件中的所有目录</p>
<p>程序员可以定制<code>PYTHONPATH</code>和<code>.pth</code>文件</p>
</blockquote>
</li>
<li><p>举出Python可能载入的能够响应import操作的四种文件类型</p>
<blockquote>
<p>Python可能载入源代码文件(.py) 、字节码文件(.pyc) 、C扩展模块(<code>.so</code>,<code>.dll</code>或<code>.pyd</code>)以及相同变量名的目录(包导入)</p>
<p>导入也可以加载更罕见的东西,例如,<code>.ZIP</code>文件组件、Python Jython版的<code>Java</code>类、IronPython的<code>.NET</code>组件以及没有文件形式的静态链接C扩展</p>
<p>有了导入钩子,<code>import</code>可以加载任何东西</p>
</blockquote>
</li>
<li><p>什么是命名空间?模块的命名空间包含了什么</p>
<blockquote>
<p>命名空间是一种独立完备的变量包,而变量就是命名空间对象的属性</p>
<p>模块的命名空间包含了代码在模块文件顶层赋值的所有变量名(也就是没有嵌套于<code>def</code>或<code>class</code>语句中)</p>
<p>从技术角度上来讲,模块的全局作用域会变成模块对象的属性命名空间</p>
<p>模块的命名空间也会将其导入的其他文件中所做的赋值运算而发生变化</p>
</blockquote>
</li>
</ol>
<hr>
<h1 id="第二十二章-模块代码编写基础"><a href="#第二十二章-模块代码编写基础" class="headerlink" title="第二十二章 模块代码编写基础"></a>第二十二章 模块代码编写基础</h1><blockquote>
<ul>
<li>查看简单的模块实例</li>
<li>讨论模块编码的基础知识:<code>import</code>和<code>from</code>语句,<code>reload</code>调用</li>
<li>研究命名空间的概念,学习导入嵌套命名空间细节,探索文件转换为模块的命名空间的过程</li>
<li>学习from语句潜在的陷阱</li>
</ul>
</blockquote>
<hr>
<h2 id="模块的创建"><a href="#模块的创建" class="headerlink" title="模块的创建"></a>模块的创建</h2><p>使用文本编辑器输入Python代码保存为<code>.py</code>文件后被自动认为是Python模块,模块对应于Python程序文件</p>
<p>在模块顶层的所有变量名都会变成模块对象的属性,可以导出供客户端使用</p>
<p>只有需要导入时模块文件名才需要<code>.py</code>后缀,执行但不会被导入的顶层文件可有可无</p>
<p>导入后的<strong>模块名</strong>及<strong>包导入中模块的文件名和目录名</strong>变成变量名,需要遵循普通变量名的命名规则</p>
<p>模块被导入时会将内部模块名映射到外部文件名,模块搜索路径中的目录路径加在前边,后缀名添加在后边</p>
<p>拓展模块是使用C或C++等外部语言编写代码创建的Python模块,作为Python脚本外部拓展库使用.被导入时拓展模块的外观和用法与Python源代码文件所编写的模块一样:通过<code>import</code>语句读取,提供函数和对象作为模块属性</p>
<hr>
<h2 id="模块的使用"><a href="#模块的使用" class="headerlink" title="模块的使用"></a>模块的使用</h2><p>在模块没有被加载时,通过<code>import</code>或<code>from</code>语句搜索、编译以及执行模块文件程序</p>
<p><code>import</code>会读取整个模块,需要定义模块名后才能读取它的变量名</p>
<p><code>from</code>直接复制模块特定的变量名</p>
<h3 id="import语句"><a href="#import语句" class="headerlink" title="import语句"></a>import语句</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># module1.py</span><br><span class="line"></span><br><span class="line">def printer(v):</span><br><span class="line">    print(v)</span><br><span class="line"></span><br><span class="line">% python</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; import module1                      # Get module as a whole</span><br><span class="line">&gt;&gt;&gt; module1.printer(&apos;Hello world!&apos;)     # QUalify to get names</span><br><span class="line">Hello world!</span><br></pre></td></tr></table></figure>

<p><code>import</code>语句使一个变量名引用整个模块对象,可以通过模块名得到该模块的属性</p>
<p>模块名可以被用来识别被载入的外部文件</p>
<p>模块名在文件加载后作为引用模块对象的变量名</p>
<h3 id="from语句"><a href="#from语句" class="headerlink" title="from语句"></a>from语句</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># module1.py</span><br><span class="line"></span><br><span class="line">def printer(v):</span><br><span class="line">    print(v)</span><br><span class="line"></span><br><span class="line">% python</span><br><span class="line">    </span><br><span class="line">&gt;&gt;&gt; from module1 import printer     # Copy out one variable</span><br><span class="line">&gt;&gt;&gt; printer(&apos;Hello world!&apos;)         # No need to qualify name</span><br><span class="line">Hello world!</span><br></pre></td></tr></table></figure>

<p><code>from</code>语句把模块中的变量名复制到导入文件的作用域,可以在导入文件中不通过模块直接使用模块的变量名</p>
<h3 id="from-语句"><a href="#from-语句" class="headerlink" title="from *语句"></a>from *语句</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># module1.py</span><br><span class="line"></span><br><span class="line">def printer(v):</span><br><span class="line">    print(v)</span><br><span class="line"></span><br><span class="line">% python</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; from module1 import *       # Copy out all variables</span><br><span class="line">&gt;&gt;&gt; printer(&apos;Hello world!&apos;)</span><br><span class="line">Hello world!</span><br></pre></td></tr></table></figure>

<p><code>*</code>会取得模块顶层所有赋了值的变量名的拷贝</p>
<p><code>from *</code>把模块中所有变量名复制到导入的作用域,将一个模块的命名空间融入了另一个模块</p>
<h3 id="导入只发生一次"><a href="#导入只发生一次" class="headerlink" title="导入只发生一次"></a>导入只发生一次</h3><p>模块只在第一次使用<code>import</code>或<code>from</code>时载入并执行,之后的导入操作只会取出已加载是模块对象</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># simple.py</span><br><span class="line"></span><br><span class="line">print(&apos;hello&apos;)</span><br><span class="line">spam = 1        # Initialize variable</span><br><span class="line"></span><br><span class="line">% python</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; import simple   # First import: loads and runs file&apos;s code</span><br><span class="line">hello</span><br><span class="line">&gt;&gt;&gt; simple.spam     # Assignment makes an attribute</span><br><span class="line">1</span><br><span class="line">&gt;&gt;&gt; simple.spam = 2 # Change attribute in module</span><br><span class="line">&gt;&gt;&gt; import simple   # Just fetches already loaded module</span><br><span class="line">&gt;&gt;&gt; simple.spam     # Code wasn&apos;t rerun:attribute unchanged</span><br></pre></td></tr></table></figure>

<p>由于模块文件中的顶层程序代码只执行一次,可以使变量进行初始化</p>
<p><code>print</code>函数和<code>=</code>语句会在第一次导入时执行,变量在导入时初始化</p>
<p>第二次及以后的导入不会重新执行模块的代码,只是从Python内部模块表中取出已创建的模块对象,变量不进行初始化</p>
<h3 id="import和from是赋值语句"><a href="#import和from是赋值语句" class="headerlink" title="import和from是赋值语句"></a>import和from是赋值语句</h3><p><code>import</code>和<code>from</code>是可执行的语句,Python在执行到这些语句时才会进行解析,被导入的模块和变量名只有这些语句执行后才可以使用</p>
<p><code>import</code>和<code>from</code>是隐性的赋值语句</p>
<blockquote>
<ul>
<li><code>import</code>将整个模块对象赋值给一个变量名</li>
<li><code>from</code>将一个或多个变量名赋值给另一个模块中同名的对象</li>
</ul>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># small.py</span><br><span class="line"></span><br><span class="line">x = 1</span><br><span class="line">y = [1, 2]</span><br><span class="line"></span><br><span class="line">% python</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; from smalll import x, y     # Copy two names out</span><br><span class="line">&gt;&gt;&gt; x = 42                      # Changes local x only</span><br><span class="line">&gt;&gt;&gt; y[0] = 42                   # Changes shared mutable in-place</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; import small                # Get module name(from doesn&apos;t)</span><br><span class="line">&gt;&gt;&gt; small.x                     # Small&apos;s x is not my x</span><br><span class="line">1</span><br><span class="line">&gt;&gt;&gt; small.y                     # But we share a changed mutable</span><br><span class="line">[42, 2]</span><br></pre></td></tr></table></figure>

<p>赋值语句的内容适用于模块的读取,<code>from</code><strong>复制的变量名</strong>与<strong>导入模块内的变量名</strong>都是对共享对象的引用,对变量名重新赋值不会影响模块内的对象,对引用可变对象的变量名修改则会影响模块内的对象</p>
<h3 id="文件间变量名的改变"><a href="#文件间变量名的改变" class="headerlink" title="文件间变量名的改变"></a>文件间变量名的改变</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># small.py</span><br><span class="line"></span><br><span class="line">x = 1</span><br><span class="line">y = [1, 2]</span><br><span class="line"></span><br><span class="line">% python</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; from small import x, y      # Copy two names out</span><br><span class="line">&gt;&gt;&gt; x = 42                      # Changes my x only</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; import small                # Get module name</span><br><span class="line">&gt;&gt;&gt; small.x = 42                # Changes x in other module</span><br></pre></td></tr></table></figure>

<p><code>from</code>赋值的变量名与导入模块的变量名没有联系,对其赋值只会修改当前作用域的变量</p>
<p><code>import</code>可以修改另一个文件中的全局变量名</p>
<h3 id="import和from的对等性"><a href="#import和from的对等性" class="headerlink" title="import和from的对等性"></a>import和from的对等性</h3><p><code>from</code>把变量名从一个模块复制到另一个模块,不会对模块名本身进行赋值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from module import name1, name2     # Copy these two names out(only)</span><br><span class="line"></span><br><span class="line">import module                       # Fetch the module object</span><br><span class="line">name1 = module.name1                # Copy names out by assignment</span><br><span class="line">name2 = module.name2</span><br><span class="line">del module                          # Get rid of the module name</span><br></pre></td></tr></table></figure>

<p><code>from</code>在导入者中创建新变量,并引用了导入模块中的同名对象,<code>from *</code>以同样的方式导入模块中所有的顶层变量名</p>
<p><code>from</code>同样会把整个模块导入到内存中而不会只加载模块文件的一部分</p>
<h3 id="from语句潜在的陷阱"><a href="#from语句潜在的陷阱" class="headerlink" title="from语句潜在的陷阱"></a>from语句潜在的陷阱</h3><p><code>from</code>语句会让变量位置更隐秘和模块,但省略输入模块的变量名很方便</p>
<p><code>from</code>导入变量时会覆盖掉作用域中现有的同名变量从而破坏命名空间,<code>from *</code>会把一个命名空间融入导入者命名空间无法看出变量名所属的模块,而<code>import</code>语句不存在这些问题</p>
<p>和<code>reload</code>调用同时使用时,<code>from</code>导入的变量名可能扔引用之前版本的对象</p>
<p>简单模块倾向于使用<code>import</code>,<code>from</code>语句用于明确列举出想要的变量,<code>from *</code>语句应限制只用一次来确定变量名所属的模块</p>
<h4 id="何时使用import"><a href="#何时使用import" class="headerlink" title="何时使用import"></a>何时使用import</h4><p>两个不同模块内定义相同变量名时必须使用<code>import</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># M.py</span><br><span class="line"></span><br><span class="line">def func():</span><br><span class="line">    ...do something</span><br><span class="line"></span><br><span class="line"># N.py</span><br><span class="line"></span><br><span class="line">def func():</span><br><span class="line">    ...do something</span><br><span class="line"># O.py</span><br><span class="line"></span><br><span class="line">from M import func      # This overwrites one we got from M</span><br><span class="line">from N import func      # Calls N.func only</span><br><span class="line">func()</span><br></pre></td></tr></table></figure>

<p>无法使用<code>from</code>语句导入不同模块的同名变量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># O.py</span><br><span class="line"></span><br><span class="line">import M, N     # Get the whole modules, not their names</span><br><span class="line">M.func()        # We can call both names now</span><br><span class="line">N.func()        # The module names make them unique</span><br></pre></td></tr></table></figure>

<p>使用<code>import</code>导入模块变量名可以访问不同模块的同名变量</p>
<hr>
<h2 id="模块命名空间"><a href="#模块命名空间" class="headerlink" title="模块命名空间"></a>模块命名空间</h2><p>模块是命名空间(变量名建立所在的场所),存在于模块之内的变量名是模块对象的属性,模块是变量名的封装</p>
<p>模块对应文件,Python建立模块对象包含模块文件内所有变量</p>
<h3 id="文件生成命名空间"><a href="#文件生成命名空间" class="headerlink" title="文件生成命名空间"></a>文件生成命名空间</h3><p>模块文件顶层每一个赋值了的变量名都会变成模块的属性,形成命名空间</p>
<blockquote>
<ul>
<li><p>模块语句会在首次导入时执行</p>
<p>系统中,模块在第一次导入时,Python会建立空的模块对象并逐一执行该模块文件内的语句</p>
</li>
<li><p>顶层的赋值语句会创建模块属性</p>
<p>在导人时,文件顶层赋值变量的语句会建立模块对象的属性,赋值的变量名会存储在模块属性的命名空间内</p>
</li>
<li><p>模块的命名空间能通过属性<code>__ dict__</code>或dir(M)获取</p>
<p>由导入建立的模块的命名空间是字典,可通过模块对象相关联的内置的<code>__ dict__</code> 属性来读取, 而且能通过<code>dir</code>函数查看</p>
<p><code>dir</code>函数大至与对象的<code>__ dict__</code>属性的键排序后的列表相等,但是它还包含了类继承的变量名</p>
</li>
<li><p>模块是一个独立的作用域(本地变量就是全局变量)</p>
<p>模块顶层变量名遵循和函数内变量名相同的引用/赋值规则,但是顶层变量名本地作用域和全局作用域相同</p>
<p>函数的变量名只会在函数执行是才存在,而模块导入后,模块文件的作用域就变成了模块对象属性的命名空间</p>
</li>
</ul>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"># module2.py</span><br><span class="line"></span><br><span class="line">print(&apos;starting to load...&apos;)</span><br><span class="line">import sys</span><br><span class="line">name = 42</span><br><span class="line">def func(): pass</span><br><span class="line">class klass: pass</span><br><span class="line">print(&apos;done loading.&apos;)</span><br><span class="line"></span><br><span class="line">% python</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; import module2</span><br><span class="line">starting to load...</span><br><span class="line">done loading.</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; module2.sys</span><br><span class="line">&lt;module &apos;sys&apos; (built-in)&gt;</span><br><span class="line">&gt;&gt;&gt; module2.name</span><br><span class="line">42</span><br><span class="line">&gt;&gt;&gt; module2.func</span><br><span class="line">&lt;function func at 0x103ff7400&gt;</span><br><span class="line">&gt;&gt;&gt; module2.klass</span><br><span class="line">&lt;class &apos;module.klass&apos;&gt;</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; list(module2.__dict__.keys())</span><br><span class="line">[&apos;__name__&apos;, &apos;__doc__&apos;, &apos;__package__&apos;, &apos;__loader__&apos;, &apos;__spec__&apos;, &apos;__file__&apos;, &apos;__cached__&apos;, &apos;__builtins__&apos;, &apos;sys&apos;, &apos;name&apos;, &apos;func&apos;, &apos;klass&apos;]</span><br></pre></td></tr></table></figure>

<p>模块首次导入时,Python从头到尾执行其中的语句,其中赋值语句会在模块命名空间内创建变量名</p>
<p>模块加载后,它的作用域就变成模块对象属性的命名空间</p>
<p>内部模块命名空间作为字典对象进行储存,有通用的字典方法,可以通过模块的<code>__dict__</code>属性获取模块命名空间字典</p>
<p>Python会在模块命名空间内加一些变量名,<code>__file__</code>指明模块从哪个文件加载,<code>__name__</code>指明导入者的名称</p>
<h3 id="属性名的点号运算"><a href="#属性名的点号运算" class="headerlink" title="属性名的点号运算"></a>属性名的点号运算</h3><p>通过<code>.</code>运算语法<code>object.attribute</code>可以获取任意object的attribute属性</p>
<p><code>.</code>运算是表达式,传回和对象匹配的属性的值,不适用于作用域法则</p>
<blockquote>
<ul>
<li><p>简单变量</p>
<p><code>X</code>是指在当前作用域内搜索变量名<code>X</code>,遵循LEGB规则运算</p>
</li>
<li><p>点号运算</p>
<p><code>X.Y</code>是指在当前范围内搜索<code>X</code>,然后搜索对象<code>X</code>之中的属性<code>Y,</code>而非在作用域内</p>
</li>
<li><p>多层点号运算</p>
<p><code>X.Y. Z</code>指的是寻找对象<code>X</code>之中的变量名<code>Y</code>，然后再找对象<code>X.Y</code>之中的<code>Z</code></p>
</li>
<li><p>通用性</p>
<p>点号运算可用于任何具有属性的对象:模块、类、C扩展类型等</p>
</li>
</ul>
</blockquote>
<h3 id="导入和作用域"><a href="#导入和作用域" class="headerlink" title="导入和作用域"></a>导入和作用域</h3><p>不导入一个文件就无法存取该文件内所定义的变量名</p>
<p>变量由源代码中的赋值语句的位置决定,而属性伴随着对对象的请求</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># moda.py</span><br><span class="line"></span><br><span class="line">X = 88          # My X: global to this file only</span><br><span class="line">def f():</span><br><span class="line">    global X    # Change this file&apos;s X</span><br><span class="line">    X = 99      # Cannot see names in other modules</span><br><span class="line"></span><br><span class="line"># modb.py</span><br><span class="line"></span><br><span class="line">X = 11          # My X: global to this file only</span><br><span class="line"></span><br><span class="line">import moda     # Gain access to names in moda</span><br><span class="line">moda.f()        # Sets moda.X, not this file&apos;s X</span><br><span class="line">print(X, moda.X)</span><br><span class="line"></span><br><span class="line">% python modb.py</span><br><span class="line">11 99</span><br></pre></td></tr></table></figure>

<p>导入操作不会赋予被导入文件中的代码上层代码的可见度:被导入文件无法看见进行导入的文件内的变量名</p>
<blockquote>
<ul>
<li>函数绝对无法看见其他函数内的变量名,除非它们从物理上处于这个函数内</li>
<li>模块程序代码绝对无法看见其他模块内的变量名,除非明确地进行了导人</li>
<li>一段程序的作用域完全由程序所处的文件中实际位置决定,作用域不会被函数调用或模块导入影响</li>
</ul>
</blockquote>
<h3 id="命名空间的嵌套"><a href="#命名空间的嵌套" class="headerlink" title="命名空间的嵌套"></a>命名空间的嵌套</h3><p>导入不会使命名空间向上嵌套,但会发生向下的嵌套,利用属性的<code>.</code>运算可能深入到任意嵌套的模块中并读取其属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">  # mod3.py</span><br><span class="line">  </span><br><span class="line">  x = 3</span><br><span class="line">  </span><br><span class="line">  # mod2.py</span><br><span class="line">  </span><br><span class="line">  X = 2</span><br><span class="line">  import mod3</span><br><span class="line">  </span><br><span class="line">  print(X, end=&apos; &apos;)       # My global X</span><br><span class="line">  print(mod3.X)           # mod3&apos;s X</span><br><span class="line">  </span><br><span class="line">  # mod3.py</span><br><span class="line">  </span><br><span class="line">  X = 1</span><br><span class="line">  import mod2</span><br><span class="line">  </span><br><span class="line">  print(X, end=&apos; &apos;)       # My global X</span><br><span class="line">  print(mod2.X, end=&apos; &apos;)  # mod2&apos;s X</span><br><span class="line">  print(mod2.mod3.X)      # Nested mod3&apos;s X</span><br><span class="line">  </span><br><span class="line">  % python mod1.py</span><br><span class="line">  2 3</span><br><span class="line">  1 2 3</span><br><span class="line">mod1`导入`mod2`时创建一个两层的嵌套命名空间,利用`mod2.mod3.X`变量名路径可以深入到导入的`mod2`内嵌套的`mod3</span><br></pre></td></tr></table></figure>

<p>然而<code>mod3</code>无法看见<code>mod2</code>内的变量名,<code>mod2</code>无法看见<code>mod1</code>的变量名</p>
<p>在<code>mod1</code>中<code>mod2</code>只是变量名,引用带有属性的对象,而对象的属性可能引用其他带有属性的对象,可以依次取出对象的属性</p>
<hr>
<h2 id="重载模块"><a href="#重载模块" class="headerlink" title="重载模块"></a>重载模块</h2><p>强制使模块代码重新载入并重新运行需要调用<code>reload</code>函数</p>
<blockquote>
<ul>
<li>导人(<code>import</code>或<code>from</code>语句)只有模块在流程中第一次导人时,加载和执行该模块的代码</li>
<li>之后的导入只会使用已加载的模块对象,而不会重载或重新执行文件的代码</li>
<li><code>reload</code>函数会强制已加载的模块的代码重新载入并重新执行,此文件中新的代码的赋值语句会在适当的地方修改现有的模块对象</li>
</ul>
</blockquote>
<p>重载模块可以无需停止整个程序而修改程序的一部分并立即看到对组件的修改效果,这样可以缩短开发的流程</p>
<p>Python是解释型语言,在执行程序导入时动态加载模块,重载进一步地提供性能优势,可以修改执行中的程序的一部分而不需终止</p>
<p><code>reload</code>只能用在Python编写的模块,C这类语言编译后的拓展模块也可以在执行中动态加载,但无法重载</p>
<h3 id="reload基础"><a href="#reload基础" class="headerlink" title="reload基础"></a>reload基础</h3><p><code>reload</code>与<code>import</code>和<code>from</code>不同的是</p>
<blockquote>
<ul>
<li><code>reload</code>是Python中的函数,而不是语句</li>
<li>传给<code>reload</code>的是成功导入了的模块对象,而不是变量名</li>
<li><code>reload</code>在Python 3.0中位于模块之中,需要先导入再使用</li>
</ul>
</blockquote>
<p>当调用<code>reload</code>时,Python会重读模块文件的源代码,重新执行其顶层语句,然后在适当的地方修改模块对象而不是删除并重建模块对象,任何引用该模块对象的地方自动受到<code>reload</code>的影响</p>
<blockquote>
<ul>
<li><p>reload会在模块当前命名空间内执行模块文件的新代码</p>
<p>重新执行模块文件的代码会覆盖其现有的命名空间,而非进行删除与重建</p>
</li>
<li><p>文件中顶层赋值语句会使得变量名换成新值</p>
<p>例如,重新执行的<code>def</code>语句会因重新赋值函数变量名而取代模块命名空间内该函数之前的版本</p>
</li>
<li><p>重载会影响所有使用<code>import</code>读取了模块的客户端</p>
<p>使用<code>import</code>的客户端需要通过<code>.</code>运算取出属性,在重载后,模块对象中属性会变成新值</p>
</li>
<li><p>重载只会对以后使用<code>from</code>的客户端造成影响</p>
<p>之前使用from来读取属性的客户端并不会受到重载的影响,那些客户端引用的依然是重载前所取出的旧对象</p>
</li>
</ul>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import module               # Initial import</span><br><span class="line">...use module.attributes...</span><br><span class="line">...                         # Now, go change the module file</span><br><span class="line">...</span><br><span class="line">from imp import reload      # Get reload itself</span><br><span class="line">reload(module)              # Get updated exports</span><br><span class="line">...use module.attributes...</span><br></pre></td></tr></table></figure>

<p>导入一个模块,在文本编辑器内修改其源代码,然后将其重载</p>
<h3 id="reload实例"><a href="#reload实例" class="headerlink" title="reload实例"></a>reload实例</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># changer.py</span><br><span class="line"></span><br><span class="line">message = &quot;First version&quot;</span><br><span class="line">def priner():</span><br><span class="line">    print(message)</span><br></pre></td></tr></table></figure>

<p>在文本编辑器中编写名为<code>changer.py</code>的模块文件,其中建立了两个变量名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">% python</span><br><span class="line">&gt;&gt;&gt; import changer</span><br><span class="line">&gt;&gt;&gt; changer.printer()</span><br><span class="line">First version</span><br></pre></td></tr></table></figure>

<p>启动Python解释器,导入该模块,然后调用其导出的函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...modify changer.py without stoppong Python...</span><br><span class="line">% vi changer.py</span><br><span class="line">message = &quot;After editing&quot;</span><br><span class="line">def printer():</span><br><span class="line">    print(&apos;reloaded:&apos;, message)</span><br></pre></td></tr></table></figure>

<p>在另一个窗口中编辑该模块文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">...back to the Python interpreter/program...</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; import changer</span><br><span class="line">&gt;&gt;&gt; changer.printer()           # No effect:uses loaded module</span><br><span class="line">First version</span><br><span class="line">&gt;&gt;&gt; from imp import reload</span><br><span class="line">&gt;&gt;&gt; reload(changer)             # Forces new cod eto load/run</span><br><span class="line">&lt;module &apos;changer&apos; from &apos;changer.py&apos;&gt;</span><br><span class="line">&gt;&gt;&gt; changer.printer()           # Runs the new version now</span><br><span class="line">reloaded: After editing</span><br></pre></td></tr></table></figure>

<p>回到Python窗口,重载该模块从而获得新的代码</p>
<p><code>reload</code>返回模块对象</p>
<h3 id="为什么要在意-模块重载"><a href="#为什么要在意-模块重载" class="headerlink" title="为什么要在意:模块重载"></a>为什么要在意:模块重载</h3><blockquote>
<ul>
<li>在交互式提示符号下可以重载模块</li>
<li>重载在较大系统也有用处,尤其是在重新启动整个程序的代价太大时</li>
<li>重载在GUI工作中也很有用,组件的回调行为可以在GUI保持活动的状态下进行修改</li>
<li>重载在Python作为C或C++程序的嵌入式语言时也有用处,C/C++程序可以请求重组其所执行的Python代码而无需停止</li>
</ul>
</blockquote>
<p>通常情况下重载使程序能够提供高度动态的接口,系统运作时通过Python定制产品而不用重新编译整个产品</p>
<hr>
<h2 id="本章习题-1"><a href="#本章习题-1" class="headerlink" title="本章习题"></a>本章习题</h2><ol>
<li><p>怎样创建模块</p>
<blockquote>
<p>要创建模块时,只需编写一个包含Python语句的文本文件就可以了,每个原代码文件都会自动成为模块,而且也没有语法用来声明模块,导人操作会把模块文件加载到内存中使其成为模块对象</p>
<p>可以用C或Java这类外部语言编写代码来创建拓展模块</p>
</blockquote>
</li>
<li><p><code>from</code>语句和<code>import</code>语句有什么关系</p>
<blockquote>
<p><code>from</code>语句与<code>import</code>语句一样导入整个模块到内存中,但是会从被导入的模块中,复制一个或多个变量到<code>from</code>语句所在的作用域中</p>
<p>这样可以让你直接使用被导入的变量名(name),而不是通过模块来使用变量名(module.name)</p>
</blockquote>
</li>
<li><p><code>reload</code>函数和导人有什么关系</p>
<blockquote>
<p>默认,模块是每个进程只导入一次,<code>reload</code>函数会强制模块再次被导入</p>
<p>基本上都是用于开发过程中选取模块源代码的新版本,或者用在动态定制的场景中</p>
</blockquote>
</li>
<li><p>什么时候必须使用<code>import</code>,不能使用<code>from</code></p>
<blockquote>
<p>当需要读取两个不同模块中的相同变量名时,就必须使用<code>import</code>,而不能用<code>from</code></p>
<p>因为你必须制定变量名所在模块,从而保证这两个变量名是独特的</p>
</blockquote>
</li>
<li><p>请列举出<code>from</code>语句三种潜在陷阱</p>
<blockquote>
<p><code>from</code>语句会让变量含义模糊(究竟是哪个模块定义的),通过reload调用时会有问题(变量名还是引用对象之前的版本),而且会破坏命名空间(可能悄悄覆盖正在作用域中使用的变量名)</p>
<p>from *形式在多数情况下都很糟糕:它会严重地污染命名空间,让变量意义变得模糊</p>
</blockquote>
</li>
</ol>
<hr>
<h1 id="第二十三章-模块包"><a href="#第二十三章-模块包" class="headerlink" title="第二十三章 模块包"></a>第二十三章 模块包</h1><blockquote>
<ul>
<li>介绍Python的包导入模型</li>
<li>介绍新的导入模式</li>
</ul>
</blockquote>
<hr>
<h2 id="包导入基础"><a href="#包导入基础" class="headerlink" title="包导入基础"></a>包导入基础</h2><p>包导入就是导入指定目录路径,把计算机上的目录变成另一个Python命名空间,而属性则对应于目录中所包含的子目录和模块文件</p>
<p>包导入提供的层次对于组织大型系统内的文件会很方便,而且可以简化模块搜索路径的设置,当多个相同名称程序文件安装在某一机器上时包导入可以解决导入的不确定性</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> dir1.dir2.mod</span><br><span class="line"><span class="keyword">from</span> dir1.dir2.mod <span class="keyword">import</span> x</span><br></pre></td></tr></table></figure>

<p>在<code>import</code>会和<code>from</code>语句中列出路径的名称彼此以点号相隔可以导入包</p>
<p>语句中的点号路径对应于机器上目录层次的路径,路径的最左边部分是<code>sys.path</code>模块搜索路径列表中的一个目录,通过这个路径可以获得文件<code>mod.py</code></p>
<p>可以通过模块搜索路径找到包含这个点号路径的容器目录,容器目录需要添加在模块搜索路径中或是顶层文件的主目录</p>
<h3 id="包和搜索路径设置"><a href="#包和搜索路径设置" class="headerlink" title="包和搜索路径设置"></a>包和搜索路径设置</h3><p><code>import</code>语句中的目录路径只能是以点号间隔的变量,需要在模块搜索路径中设置包含点号路径的容器目录,可以将容器目录增加至<code>PYTHONPATH</code>系统变量或是<code>.pth</code>文件中</p>
<p><code>import</code>语句以与平台不相关的方式提供了目录路径的写法</p>
<h3 id="init-py包文件"><a href="#init-py包文件" class="headerlink" title="__init__.py包文件"></a><code>__init__.py</code>包文件</h3><p>使用包导入遵循的规则</p>
<blockquote>
<ul>
<li>包导入语句的路径中的<strong>每个目录内</strong>都必须有<code>__init__.py</code>,否则导入包失败</li>
<li>容器目录不需要<code>__init__.py</code>文件,会自动将其忽略</li>
<li>容器目录必须列在模块搜索路径上</li>
</ul>
</blockquote>
<p><code>__init__.py</code>可以像普通模块文件一样包含Python程序代码,也可以完全是空的</p>
<blockquote>
<ul>
<li><p>作为Python的一种声明</p>
<p>防止Python挑选出搜索路径上位置较前的相同名称的其他目录</p>
</li>
<li><p>包的初始化</p>
<p>Python首次导入某个目录时,会自动执行该目录下<code>__ init__.py</code>文件中的所有程序代码,这类文件是放置包内文件所需要初始化的代码的场所</p>
</li>
<li><p>模块命名空间的初始化</p>
<p>在包导入的模型中,脚本内的目录路径,在导入后会变成真实的嵌套对象路径</p>
<p><code>__init__.py</code>文件为目录所创建的模块对象提供命名空间</p>
</li>
<li><p><code>from *</code>语句的行为</p>
<p>在<code>__init__.py</code>文件中,<code>__ all__</code>列表是指当包名称使用<code>from *</code>的时候,应该导入的子模块的名称单</p>
<p>如果没有设定<code>__all__</code>,<code>from *</code>语句不会自动加载嵌套于该目录内的子模块,只加载该目录的<code>__ init__.py</code>文件中赋值语句定义的变量名,包括该文件中程序代码明确导入的任何子模块</p>
</li>
</ul>
</blockquote>
<hr>
<h2 id="包导入实例"><a href="#包导入实例" class="headerlink" title="包导入实例"></a>包导入实例</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># dir1/__init__.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> (<span class="string">'dir1 init'</span>)</span><br><span class="line">x = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># dir1/dir2/__init__.py</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'dir2 init'</span>)</span><br><span class="line">y = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># dir1/dir2/mod.py</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'in mod.py'</span>)</span><br><span class="line">z = <span class="number">3</span></span><br></pre></td></tr></table></figure>

<p>其中dir1是模块搜索路径中一个目录的子目录,dir1的容器目录不需要<code>__int__.py</code>文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> dir1.dir2.mod		<span class="comment"># First imports run init files</span></span><br><span class="line">dir1 init</span><br><span class="line">dir2 init</span><br><span class="line"><span class="keyword">in</span> mod.py</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> dir1.dir2.mod		<span class="comment"># Later imports do not</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> imp <span class="keyword">import</span> reload		<span class="comment"># Needed in 3.0</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>reload(dir1)</span><br><span class="line">dir1 init</span><br><span class="line">&lt;module <span class="string">'dir1'</span> <span class="keyword">from</span> <span class="string">'/test/dir1/__init__.py'</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>reload(dir1.dir2)</span><br><span class="line">dir2 init</span><br><span class="line">&lt;module <span class="string">'dir1.dir2'</span> <span class="keyword">from</span> <span class="string">'/test/dir1/dir2/__init__.py'</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dir1</span><br><span class="line">&lt;module <span class="string">'dir1'</span> <span class="keyword">from</span> <span class="string">'/test/dir1/__init__.py'</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dir1.dir2</span><br><span class="line">&lt;module <span class="string">'dir1.dir2'</span> <span class="keyword">from</span> <span class="string">'/test/dir1/dir2/__init__.py'</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dir1.dir2.mod</span><br><span class="line">&lt;module <span class="string">'dir1.dir2.mod'</span> <span class="keyword">from</span> <span class="string">'/test/dir1/dir2/mod.py'</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dir1.x</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dir1.dir2.y</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dir1.dir2.mod.z</span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure>

<p>当Python向下搜索路径时,<code>import</code>语句会在每个目录首次遍历时执行该目录的初始化文件</p>
<p>任何已导入的目录可以传递给<code>reload</code>强制该项目重新执行,<code>reload</code>可以接受点号路径名称重载嵌套的目录和文件</p>
<p>导入后<code>import</code>语句内的路径会变成脚本的<strong>嵌套对象</strong>路径,路径中的每个目录名称都会变成赋值为<strong>模块对象</strong>的变量,模块对象的命名空间则是由该目录内的<code>__init__.py</code>文件中所有赋值语句进行初始化的</p>
<h3 id="包对应的from语句和import语句"><a href="#包对应的from语句和import语句" class="headerlink" title="包对应的from语句和import语句"></a>包对应的from语句和import语句</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>dir2.mod</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">NameError: name <span class="string">'dir2'</span> <span class="keyword">is</span> <span class="keyword">not</span> defined</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>mod.z</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">NameError: name <span class="string">'mod'</span> <span class="keyword">is</span> <span class="keyword">not</span> defined</span><br></pre></td></tr></table></figure>

<p><code>import</code>和包一起使用时必须经常在程序中重新输入完整的路径</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> dir1.dir2 <span class="keyword">import</span> mod		<span class="comment"># Code path here only</span></span><br><span class="line">dir1 init</span><br><span class="line">dir2 init</span><br><span class="line"><span class="keyword">in</span> mod.py</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>mod.z							<span class="comment"># Don't repeat path</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> dir1.dir2.mod <span class="keyword">import</span> z</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>z</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> dir1.dir2.mod <span class="keyword">as</span> mod		<span class="comment"># Use shorter name</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>mod.z</span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure>

<p>使用<code>from</code>导入包可以避免每次读取时都重新输入完整路径,并且在重新改变目录树结构时<code>from</code>只需要在程序代码中更新一次路径</p>
<p><code>import</code>拓展功能<code>import as</code>提供类似功能</p>
<hr>
<h2 id="为什么要使用包导入"><a href="#为什么要使用包导入" class="headerlink" title="为什么要使用包导入"></a>为什么要使用包导入</h2><p>包让导入更具信息性,并可以作为组织工具简化模块的搜索路径,而且可以解决模糊性</p>
<ul>
<li><p>包导入提供了程序文件的目录信息,可以作为组织工具轻松地找到文件,没有包导入时需要通过查看模块搜索路径才能找出文件</p>
</li>
<li><p>包导入可以大幅简化<code>PYTHONPATH</code>和<code>.pth</code>文件搜索路径设置,若将所有Python程序代码都存放在一个共同的根目录,搜索路径上只需要根目录一个接入点,即可通过包导入导入所有的程序代码</p>
</li>
<li><p>包导入使想导入的文件更明确,从而解决了模糊性</p>
</li>
<li><p>根据功能把文件组织成子目录,包导入会让模块扮演的角色更为明显,也使代码更具可读性</p>
</li>
<li><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> utilities</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> database.client.utilities</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="三个系统的传说"><a href="#三个系统的传说" class="headerlink" title="三个系统的传说"></a>三个系统的传说</h3><p>实际中需要包导入的场合就是解决多个同名程序文件安装在同一个机器上时所引发的模糊性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">root/</span><br><span class="line">	system1/</span><br><span class="line">		__init__.py</span><br><span class="line">		utilities.py</span><br><span class="line">		main.py</span><br><span class="line">		other.py</span><br><span class="line">	system2/</span><br><span class="line">		__init__.py</span><br><span class="line">		utilities.py</span><br><span class="line">		main.py</span><br><span class="line">		other.py</span><br><span class="line">	system3</span><br><span class="line">		__init__.py</span><br><span class="line">		myfile.py</span><br></pre></td></tr></table></figure>

<p>system1与system2包含了相同名称的模块文件:启动程序<code>main.py</code>与通用工具代码<code>utilities.py</code></p>
<p>两个系统不需要配置模块搜索路径,运行<code>main.py</code>后同一主目录下的<code>utilities.py</code>在导入时最先被搜索到</p>
<p>当在第三个系统中导入前两个系统程序<code>utilities.py</code>时需要设置模块搜索路径,但是总会得到搜索路径上最先列出的目录内的<code>utilities.py</code>,而修改<code>sys.path</code>很容易出错</p>
<p>将三个系统放在共同根目录下并将根目录添加到搜索路径中,可以在系统三中以包导入任何一个系统的工具文件</p>
<blockquote>
<ul>
<li>当各路径具有同名属性时使用<code>import</code>,不同时则可以使用<code>from</code>避免重复输入完整包的路径问题</li>
<li><code>__init__.py</code>文件不需要在根目录内增加,只有在程序代码内需要</li>
<li>系统三不需要放在根目录下,只有被导入的代码包需要</li>
<li>两个初始系统的导入依然正常工作,因为会先搜索顶层文件所在的主目录</li>
</ul>
</blockquote>
<hr>
<h2 id="包相对导入"><a href="#包相对导入" class="headerlink" title="包相对导入"></a>包相对导入</h2><p>在包自身内部,包文件的导入可以使用和外部导入相同的路径语法,也可以使用特殊的包内搜索规则来简化导入语句</p>
<p>包内的导入可能相对于包而不是列出包导入路径</p>
<h3 id="Python-3-0中的变化"><a href="#Python-3-0中的变化" class="headerlink" title="Python 3.0中的变化"></a>Python 3.0中的变化</h3><p>包中导入在Python 3.0中的两个变化</p>
<blockquote>
<ul>
<li>修改模块导入搜索路径语义,以默认地跳过包自己的目录,导入只是检查搜索路径的其他组件,这叫做<strong>绝对</strong>导入</li>
<li>拓展<code>from</code>语句的语法,以允许显式地要求导入只捜索包的目录,这叫做<strong>相对</strong>导入语法</li>
</ul>
</blockquote>
<h3 id="相对导入基础知识"><a href="#相对导入基础知识" class="headerlink" title="相对导入基础知识"></a>相对导入基础知识</h3><p><code>from</code>语句使用<code>.</code>指定,需要位于<strong>同一包中</strong>的模块,而不是位于模块导入搜索路径上某处的模块</p>
<blockquote>
<ul>
<li>使用<code>from .</code>来表示导入应该相对于外围的包,这样的导入将只是在包的内部搜索,并且不会搜索位于导入搜索路径(<code>sys. path</code>)上某处的同名模块,直接效果是包模块覆盖了外部的模块</li>
<li>Python3.0中,在一个包中导入默认是绝对的,在缺少任何特殊的<code>.</code>语法的时候,导入忽略了包含包自身并在sys .path搜索路径上的某处查找</li>
</ul>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> spam		<span class="comment"># Relative to  this package</span></span><br></pre></td></tr></table></figure>

<p>将位于与语句中给出的文件相同路径中名为<code>spam</code>模块导入</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> .spam <span class="keyword">import</span> name</span><br></pre></td></tr></table></figure>

<p>从名为<code>spam</code>的模块导入变量<code>name</code>,spam模块与包含这条语句的文件位于同一个包下</p>
<h3 id="为什么使用相对导入"><a href="#为什么使用相对导入" class="headerlink" title="为什么使用相对导入"></a>为什么使用相对导入</h3><p>当脚本在同名文件出现在模块搜索路径上许多地方时,可以解决模糊性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mypkg/</span><br><span class="line">	__Init__.py</span><br><span class="line">	main.py</span><br><span class="line">	strign.py</span><br></pre></td></tr></table></figure>

<p>当<code>main.py</code>试图导入<code>string</code>模块时将会导入<code>mypkg</code>目录下的<code>string.py</code>文件而无法导入Python标准库的<code>string</code>模块</p>
<h4 id="Python-3-0中的相对导入解决方案"><a href="#Python-3-0中的相对导入解决方案" class="headerlink" title="Python 3.0中的相对导入解决方案"></a>Python 3.0中的相对导入解决方案</h4><h3 id="相对导入的作用域"><a href="#相对导入的作用域" class="headerlink" title="相对导入的作用域"></a>相对导入的作用域</h3><h3 id="模块查找规则总结"><a href="#模块查找规则总结" class="headerlink" title="模块查找规则总结"></a>模块查找规则总结</h3><h3 id="相对导入的应用"><a href="#相对导入的应用" class="headerlink" title="相对导入的应用"></a>相对导入的应用</h3><h3 id="为什么要在意-模块包"><a href="#为什么要在意-模块包" class="headerlink" title="为什么要在意:模块包"></a>为什么要在意:模块包</h3><hr>
<h2 id="本章习题-2"><a href="#本章习题-2" class="headerlink" title="本章习题"></a>本章习题</h2><ol>
<li><p>模块包目录内的<code>__ init__ .py</code>文 件有何用途</p>
<blockquote>
<p><code>__init__.py</code>文件是用于声明和初始化模块包的</p>
<p>第一次在进程中导入某目录时,Python会自动运行这个文件中的代码</p>
<p>其赋值的变量会变成对应于该目录在内存中所创建的模块对象的属性</p>
<p>它不是选用的:如果一个目录中没有包含这个文件的话,是无法通过包语法导人目录的</p>
</blockquote>
</li>
<li><p>每次引用包的内容时，如何避免重复包的完整路径</p>
<blockquote>
<p>通过<code>from</code>语句使用包,直接把包的变量名复制出来,或者使用<code>import</code>语句的<code>as</code>扩展功能,把路径改为较短的别名</p>
<p>在这种情况下,路径只出现在了一个地方,就在<code>from</code>或<code>import</code>语句中</p>
</blockquote>
</li>
<li><p>哪些目录需要<code>__init__.py</code>文件</p>
<blockquote>
<p>import或from语句中所列出的每个目录都必须含有<code>__init__.py</code>文件</p>
<p>其他目录则不需要包含这个文件,包括含有包路径最左侧组件的目录</p>
</blockquote>
</li>
<li><p>在什么情况下必须通过<code>import</code>而不能通过<code>from</code>使用包</p>
<blockquote>
<p>只有在你需要读取定义在一个以上路径的相同变量名时,才必须通过<code>import</code>来使用包,而不能使用<code>from</code></p>
<p>使用<code>import</code>路径可让引用独特化,然而<code>from</code>却让任何变量名只有一个版本</p>
</blockquote>
</li>
<li><p><code>from mypkg import spam</code>和<code>from import spam</code>有什么差别</p>
<blockquote>
<p><code>from mypkg import spam</code>是绝对导入:mypkg的搜索掠过包路径并且mypkg位于<code>sys. path</code>中的一“个绝对目录中</p>
<p>另一方面,<code>from.import spam</code>是相对导入:spam的查找是相对于该语句所在的包,然后才会去搜索<code>sys.path</code></p>
</blockquote>
</li>
</ol>
<hr>
<h1 id="第二十四章-高级模块话题"><a href="#第二十四章-高级模块话题" class="headerlink" title="第二十四章 高级模块话题"></a>第二十四章 高级模块话题</h1><blockquote>
<ul>
<li>本章介绍数据隐藏、<code>__future__</code>模块、<code>__name__</code>变量、<code>sys.path</code>修改、列表工具、通过名称字符串来运行模块、过渡式重载等</li>
<li>探索和总结模块设计</li>
<li>相关陷阱和练习题</li>
</ul>
</blockquote>
<hr>
<h2 id="在模块中隐藏数据"><a href="#在模块中隐藏数据" class="headerlink" title="在模块中隐藏数据"></a>在模块中隐藏数据</h2><p>Python导入模块时会导入其文件顶层所赋值的所有变量名,没有使变量名在模块内可见或不可见的概念</p>
<p>没有防止客户端修改模块内变量名的办法</p>
<h3 id="最小化from-的破坏-X和-all"><a href="#最小化from-的破坏-X和-all" class="headerlink" title="最小化from *的破坏:_X和__all__"></a>最小化<code>from *</code>的破坏:<code>_X</code>和<code>__all__</code></h3><p><code>from *</code>语句导入模块时不会复制加有下划线的变量名,使对命名空间的破坏最小化</p>
<p>使用其他导入形式如<code>import</code>可以看见并修改带有下划线的变量名</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__all__ = [<span class="string">"Error"</span>, <span class="string">"encode"</span>, <span class="string">"decode"</span>]		<span class="comment"># Export these only</span></span><br></pre></td></tr></table></figure>

<p> 在模块顶层把变量名的字符串列表赋值给<code>__all__</code>,<code>from *</code>语句只会把在<code>__all__</code>列表中的这些变量名复制出来</p>
<p><code>__all__</code>列表对于其他导入形式同样无效</p>
<hr>
<h2 id="启用以后的语言特性"><a href="#启用以后的语言特性" class="headerlink" title="启用以后的语言特性"></a>启用以后的语言特性</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> featurename</span><br></pre></td></tr></table></figure>

<p>以拓展功能的方式使用新的的语言特性</p>
<p>这个语句一般出现在模块文件的顶端,以每个模块为基础,开启特殊的代码编译</p>
<p>可以出现在交互模式提示符下实验新的语言特性</p>
<hr>
<h2 id="混合用法模式-name-和-main"><a href="#混合用法模式-name-和-main" class="headerlink" title="混合用法模式:__name__和__main__"></a>混合用法模式:<code>__name__</code>和<code>__main__</code></h2><p>每个模块都有名为<code>__name__</code>的内置属性</p>
<blockquote>
<ul>
<li>如果文件是以顶层程序文件执行,在启动时,<code>__name__</code>会设置为字符串<code>__main__</code></li>
<li>如果文件被导入,<code>__name__</code>会改设成的模块名</li>
</ul>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># runme.py</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tester</span><span class="params">()</span>:</span></span><br><span class="line">	print(<span class="string">"It's Christmas in Heaven..."</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:		<span class="comment"># Only when run</span></span><br><span class="line">    tester()					<span class="comment"># Not when import</span></span><br><span class="line"></span><br><span class="line">% python</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> runme</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>runme.tester()</span><br><span class="line">It<span class="string">'s Christmas in Heaven...</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">% python runme.py</span></span><br><span class="line"><span class="string">It'</span>s Christmas <span class="keyword">in</span> Heaven...</span><br></pre></td></tr></table></figure>

<p><code>__name__</code>变量充当使用模式标志,模块可以检测自己的<code>__name__</code>来确定是被执行还是被导入</p>
<p>使用<code>__ name__</code>测试最常见的是自我测试代码,在文件末尾添加<code>__name__</code>测试,把测试代码放在测试模块中,可以在客户端导入该文件并使用,也可以独立执行测试程序</p>
<p>使用<code>__name__</code>测试编写既可以作为命令行工具也可以作为工具库使用的文件,当文件独立执行时自动调用文件中的函数</p>
<h3 id="以-name-进行单元测试"><a href="#以-name-进行单元测试" class="headerlink" title="以__name__进行单元测试"></a>以<code>__name__</code>进行单元测试</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># min.py</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'I am:'</span>, __name__)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">minmax</span><span class="params">(test, *args)</span>:</span></span><br><span class="line">	res = args[<span class="number">0</span>]</span><br><span class="line">	<span class="keyword">for</span> arg <span class="keyword">in</span> args[<span class="number">1</span>:]:</span><br><span class="line">		<span class="keyword">if</span> test(arg, res):</span><br><span class="line">			res = arg</span><br><span class="line">	<span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lessthan</span><span class="params">(x, y)</span>:</span> <span class="keyword">return</span> x &lt; y</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">grtrthan</span><span class="params">(x, y)</span>:</span> <span class="keyword">return</span> x &gt; y</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    print(minmax(lessthan, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">3</span>))	<span class="comment"># Self-test code</span></span><br><span class="line">    print(minmax(grtrthan, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">3</span>))</span><br><span class="line"></span><br><span class="line">% python min.py</span><br><span class="line"></span><br><span class="line">I am: __main__</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">6</span></span><br><span class="line"></span><br><span class="line">% python</span><br><span class="line"></span><br><span class="line">I am: min</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>min.minmax(min.lessthan, <span class="string">'s'</span>, <span class="string">'p'</span>, <span class="string">'a'</span>, <span class="string">'m'</span>)</span><br><span class="line"><span class="string">'a'</span></span><br></pre></td></tr></table></figure>

<p>在<code>__name__</code>检查区块内封装自我测试的调用,使其在文件作为顶层脚本执行时启动,而导入时则不会</p>
<p>Python开始加载文件时就创建了<code>__name__</code>变量并对其赋值,当顶层脚本执行这个文件时设置名称为<code>__main__</code></p>
<h3 id="使用带有-name-的命令行参数"><a href="#使用带有-name-的命令行参数" class="headerlink" title="使用带有__name__的命令行参数"></a>使用带有<code>__name__</code>的命令行参数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">Various specialized string display formatting utilities.</span></span><br><span class="line"><span class="string">Test me with canned self-test or command-line arguments.</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">commas</span><span class="params">(N)</span>:</span></span><br><span class="line">	<span class="string">"""</span></span><br><span class="line"><span class="string">	format positive integer-like N for display with</span></span><br><span class="line"><span class="string">	commas between digit groupings: xxx,yyy,zzz</span></span><br><span class="line"><span class="string">	"""</span></span><br><span class="line">	digits = str(N)</span><br><span class="line">	<span class="keyword">assert</span>(digits.isdigit())</span><br><span class="line">	result = <span class="string">''</span></span><br><span class="line">	<span class="keyword">while</span> digits:</span><br><span class="line">		digits, last3 = digits[:<span class="number">-3</span>], digits[<span class="number">-3</span>:]</span><br><span class="line">		result = (last3 + <span class="string">','</span> + result) <span class="keyword">if</span> result <span class="keyword">else</span> last3</span><br><span class="line">	<span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">money</span><span class="params">(N, width=<span class="number">0</span>)</span>:</span></span><br><span class="line">	<span class="string">"""</span></span><br><span class="line"><span class="string">	format number N for display with commas, 2 decimal digits,</span></span><br><span class="line"><span class="string">	leading $ and sign, and optional padding: $ -xxx,yyy.zz</span></span><br><span class="line"><span class="string">	"""</span></span><br><span class="line">	sign = <span class="string">'-'</span> <span class="keyword">if</span> N &lt; <span class="number">0</span> <span class="keyword">else</span> <span class="string">''</span></span><br><span class="line">	N = abs(N)</span><br><span class="line">	whole = commas(int(N))</span><br><span class="line">	fract = (<span class="string">'%.2f'</span> % N)[<span class="number">-2</span>:]</span><br><span class="line">	format = <span class="string">'%s%s.%s'</span> % (sign, whole, fract)</span><br><span class="line">	<span class="keyword">return</span> <span class="string">'$%*s'</span> % (width, format)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">selftest</span><span class="params">()</span>:</span></span><br><span class="line">		tests = <span class="number">0</span>, <span class="number">1</span>				<span class="comment"># fails: -1, 1.23</span></span><br><span class="line">		tests += <span class="number">12</span>, <span class="number">123</span>, <span class="number">12134</span>, <span class="number">12345</span>, <span class="number">123456</span>, <span class="number">1234567</span></span><br><span class="line">		tests += <span class="number">2</span> ** <span class="number">32</span>, <span class="number">2</span> ** <span class="number">100</span></span><br><span class="line">		<span class="keyword">for</span> test <span class="keyword">in</span> tests:</span><br><span class="line">			print(commas(test))</span><br><span class="line"></span><br><span class="line">		print(<span class="string">''</span>)</span><br><span class="line">		tests = <span class="number">0</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">1.23</span>, <span class="number">1.</span>, <span class="number">1.2</span>, <span class="number">3.14159</span></span><br><span class="line">		tests += <span class="number">12.34</span>, <span class="number">12.344</span>, <span class="number">12.345</span>, <span class="number">12.346</span></span><br><span class="line">		tests += <span class="number">2</span> ** <span class="number">32</span>, (<span class="number">2</span> ** <span class="number">32</span> + <span class="number">.2345</span>)</span><br><span class="line">		tests += <span class="number">1.2345</span>, <span class="number">1.2</span>, <span class="number">0.2345</span></span><br><span class="line">		tests += <span class="number">-1.2345</span>, <span class="number">-1.2</span>, <span class="number">-0.2345</span></span><br><span class="line">		tests += -(<span class="number">2</span> ** <span class="number">32</span>), -(<span class="number">2</span> ** <span class="number">32</span> + <span class="number">.2345</span>)</span><br><span class="line">		tests += (<span class="number">2</span> ** <span class="number">100</span>), -(<span class="number">2</span> ** <span class="number">100</span>)</span><br><span class="line">		<span class="keyword">for</span> test <span class="keyword">in</span> tests:</span><br><span class="line">			print(<span class="string">'%s [%s]'</span> % (money(test, <span class="number">17</span>), test))</span><br><span class="line">	<span class="keyword">import</span> sys</span><br><span class="line">	<span class="keyword">if</span> len(sys.argv) == <span class="number">1</span>:</span><br><span class="line">		selftest()</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		print(money(float(sys.argv[<span class="number">1</span>]), int(sys.argv[<span class="number">2</span>])))</span><br></pre></td></tr></table></figure>

<p>程序定义了字符串格式化工具</p>
<p><code>sys.argv</code>列表包含了命令行参数,它是在命令行上录入单词的一个字符串列表,其中第一项是将要运行的脚本的名称</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">%python formats.py 999999999 0</span><br><span class="line"><span class="variable">$999</span>,999,999.00</span><br><span class="line"></span><br><span class="line">%python formats.py -999999999 0</span><br><span class="line">$-999,999,999.00</span><br><span class="line"></span><br><span class="line">%python formats.py 123456789012345 0</span><br><span class="line"><span class="variable">$123</span>,456,789,012,345.00</span><br><span class="line"></span><br><span class="line">%python formats.py -123456789012345 25</span><br><span class="line">$  -123,456,789,012,345.00</span><br><span class="line"></span><br><span class="line">%python formats.py 123.456 0</span><br><span class="line"><span class="variable">$123</span>.46</span><br><span class="line"></span><br><span class="line">%python formats.py -123.454 0</span><br><span class="line">$-123.45</span><br><span class="line"></span><br><span class="line">%python formats.py</span><br><span class="line">0</span><br><span class="line">1</span><br><span class="line">12</span><br><span class="line">123</span><br><span class="line">12,134</span><br><span class="line">12,345</span><br><span class="line">123,456</span><br><span class="line">1,234,567</span><br><span class="line">4,294,967,296</span><br><span class="line">1,267,650,600,228,229,401,496,703,205,376</span><br><span class="line"></span><br><span class="line">$             0.00 [0]</span><br><span class="line">$             1.00 [1]</span><br><span class="line">$            -1.00 [-1]</span><br><span class="line">$             1.23 [1.23]</span><br><span class="line">$             1.00 [1.0]</span><br><span class="line">$             1.20 [1.2]</span><br><span class="line">$             3.14 [3.14159]</span><br><span class="line">$            12.34 [12.34]</span><br><span class="line">$            12.34 [12.344]</span><br><span class="line">$            12.35 [12.345]</span><br><span class="line">$            12.35 [12.346]</span><br><span class="line">$ 4,294,967,296.00 [4294967296]</span><br><span class="line">$ 4,294,967,296.23 [4294967296.2345]</span><br><span class="line">$             1.23 [1.2345]</span><br><span class="line">$             1.20 [1.2]</span><br><span class="line">$             0.23 [0.2345]</span><br><span class="line">$            -1.23 [-1.2345]</span><br><span class="line">$            -1.20 [-1.2]</span><br><span class="line">$            -0.23 [-0.2345]</span><br><span class="line">$-4,294,967,296.00 [-4294967296]</span><br><span class="line">$-4,294,967,296.23 [-4294967296.2345]</span><br><span class="line"><span class="variable">$1</span>,267,650,600,228,229,401,496,703,205,376.00 [1267650600228229401496703205376]</span><br><span class="line">$-1,267,650,600,228,229,401,496,703,205,376.00 [-1267650600228229401496703205376]</span><br></pre></td></tr></table></figure>

<p>作为顶层脚本运行时测试并使用系统命令行上列出的参数运行一个定制的或传入的参数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> formats <span class="keyword">import</span> money, commas</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>money(<span class="number">123.456</span>)</span><br><span class="line"><span class="string">'$123.46'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>money(<span class="number">-9999999.99</span>, <span class="number">15</span>)</span><br><span class="line"><span class="string">'$  -9,999,999.99'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>X = <span class="number">99999999999999999999</span> </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'%s (%s)'</span> % (commas(X), X)</span><br><span class="line"><span class="string">'99,999,999,999,999,999,999 (99999999999999999999)'</span></span><br></pre></td></tr></table></figure>

<p>可以把这些工具作为库的部分导入到其他的环境中</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> formats</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>help(formats)</span><br><span class="line"></span><br><span class="line">Help on module formats:</span><br><span class="line"></span><br><span class="line">NAME</span><br><span class="line">    formats</span><br><span class="line"></span><br><span class="line">DESCRIPTION</span><br><span class="line">    Various specialized string display formatting utilities.</span><br><span class="line">    Test me <span class="keyword">with</span> canned self-test <span class="keyword">or</span> command-line arguments.</span><br><span class="line"></span><br><span class="line">FUNCTIONS</span><br><span class="line">    commas(N)</span><br><span class="line">        format positive integer-like N <span class="keyword">for</span> display <span class="keyword">with</span></span><br><span class="line">        commas between digit groupings: xxx,yyy,zzz</span><br><span class="line">    </span><br><span class="line">    money(N, width=<span class="number">0</span>)</span><br><span class="line">        format number N <span class="keyword">for</span> display <span class="keyword">with</span> commas, <span class="number">2</span> decimal digits,</span><br><span class="line">        leading $ <span class="keyword">and</span> sign, <span class="keyword">and</span> optional padding: $ -xxx,yyy.zz</span><br><span class="line"></span><br><span class="line">FILE</span><br><span class="line">    /formats.py</span><br></pre></td></tr></table></figure>

<p>可以使用<code>help</code>函数研究其工具</p>
<hr>
<h2 id="修改模块搜索路径"><a href="#修改模块搜索路径" class="headerlink" title="修改模块搜索路径"></a>修改模块搜索路径</h2><p>模块搜索路径是一个目录列表,可以通过环境变量<code>PYTHONPATH</code>以及<code>.pth</code>路径文件进行定制</p>
<p>Python程序本身可以通过修改<code>sys.path</code>的内置列表来修改搜索路径</p>
<p><code>sys.path</code>的设置方法只在修改的Python会话或程序中才会存续,程序结束后不会保留下来,<code>PYTHONPATH</code>和<code>.pth</code>文件路径配置保存在系统中,程序结束后仍然存在</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> sys</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.path</span><br><span class="line">[<span class="string">''</span>, <span class="string">'/Library/Frameworks/Python.framework/Versions/3.6/lib/python36.zip'</span>, <span class="string">'/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6'</span>, <span class="string">'/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/lib-dynload'</span>, <span class="string">'/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.path.append(<span class="string">'/sourcedir'</span>)		<span class="comment"># Extend module search path</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> string						<span class="comment"># All imports search the new dir last</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.path = [<span class="string">r'/temp'</span>]				<span class="comment"># Change module search path</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.path.append(<span class="string">'/example'</span>)			<span class="comment"># For this process only</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.path</span><br><span class="line">[<span class="string">'/temp'</span>, <span class="string">'/example'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> string</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">ModuleNotFoundError: No module named <span class="string">'string'</span></span><br></pre></td></tr></table></figure>

<p><code>sys.path</code>在程序启动时初始化,之后可以随意对元素进行删除、附加和重设</p>
<p>对<code>sys.path</code>做了修改会对导入的地方产生影响,从而在Python程序中动态配置搜索路径</p>
<hr>
<h2 id="Import语句和from语句的as拓展"><a href="#Import语句和from语句的as拓展" class="headerlink" title="Import语句和from语句的as拓展"></a>Import语句和from语句的as拓展</h2><p><code>import</code>和<code>from</code>语句可以拓展,将模块对象赋值为不同的变量名</p>
<p>语句:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> modulename <span class="keyword">as</span> name</span><br></pre></td></tr></table></figure>

<p>相当于:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> modulename</span><br><span class="line">name = modulename</span><br><span class="line"><span class="keyword">del</span> modulename			<span class="comment"># Don't keep original name</span></span><br></pre></td></tr></table></figure>

<p>使用<code>as</code>拓展后可以使用<code>as</code>之后的变量名引用该模块</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> modulename <span class="keyword">import</span> attrname <span class="keyword">as</span> name</span><br></pre></td></tr></table></figure>

<p><code>from</code>语句也可以使用<code>as</code>拓展</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> reallylongmodulename <span class="keyword">as</span> name		<span class="comment"># Use shorter nickname</span></span><br><span class="line">name.func()</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> module1 <span class="keyword">import</span> utility <span class="keyword">as</span> util1</span><br><span class="line"><span class="keyword">from</span> module2 <span class="keyword">import</span> utility <span class="keyword">as</span> util2</span><br><span class="line">util1(); util2()</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> dir1.dir2.mod <span class="keyword">as</span> mod				<span class="comment"># Only list full path once</span></span><br><span class="line">mod.func()</span><br></pre></td></tr></table></figure>

<p><code>as</code>拓展可以将较长的变量名替换为较短的变量名</p>
<p><code>as</code>拓展可以避免不同模块中的相同变量名被覆盖</p>
<p>在包导入中可以将整个目录路径替换为较短的变量名</p>
<hr>
<h2 id="模块是对象-元程序"><a href="#模块是对象-元程序" class="headerlink" title="模块是对象:元程序"></a>模块是对象:元程序</h2><p>管理其他程序的程序为<code>元程序</code>,在其他系统之上工作</p>
<p><code>元程序</code>也称为<code>内省</code>,因为程序能看见和处理对象的内部,还能用作创建程序的工具</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">M.name					<span class="comment"># Qualify object</span></span><br><span class="line">M.__dict__[<span class="string">'name'</span>]		<span class="comment"># Index namespace dictionary manually</span></span><br><span class="line">sys.modules[<span class="string">'M'</span>].name	<span class="comment"># Index loaded-modules table manually</span></span><br><span class="line">getattr(M, <span class="string">'name'</span>)		<span class="comment"># Call built-in fetch function</span></span><br></pre></td></tr></table></figure>

<p>取得M模块中的name属性</p>
<blockquote>
<ul>
<li>可以使用<code>.</code>运算</li>
<li>对模块的属性字典<code>__dict__</code>索引运算</li>
<li>在<code>sys.modules</code>字典中导出已加载模块</li>
<li>内置函数<code>getattr</code>以字符串名取出属性</li>
</ul>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">mydir.py: a module that lists the namespaces of other modules</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">seplen = <span class="number">60</span></span><br><span class="line">sepchr = <span class="string">'-'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">listing</span><span class="params">(module, verbose=True)</span>:</span></span><br><span class="line">	sepline = sepchr * seplen</span><br><span class="line">	<span class="keyword">if</span> verbose:</span><br><span class="line">		print(sepline)</span><br><span class="line">		print(<span class="string">'name:'</span>, module.__name__, <span class="string">'file:'</span>, module.__file__)</span><br><span class="line">		print(sepline)</span><br><span class="line"></span><br><span class="line">	count = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> attr <span class="keyword">in</span> module.__dict__:					<span class="comment"># Scan namespace keys</span></span><br><span class="line">		print(<span class="string">'%02d) %s'</span> % (count, attr), end=<span class="string">' '</span>)</span><br><span class="line">		<span class="keyword">if</span> attr.startwith(<span class="string">'__'</span>):</span><br><span class="line">			print(<span class="string">'&lt;built-in name&gt;'</span>)				<span class="comment"># Skip __file__, etc.</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			print(getattr(module, attr))			<span class="comment"># Same as .__dict__[attr]</span></span><br><span class="line">		count += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> verbose:</span><br><span class="line">		print(sepline)</span><br><span class="line">		print(module.__name__, <span class="string">'has %d names'</span> % count)</span><br><span class="line">		print(sepline)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">	<span class="keyword">import</span> mydir</span><br><span class="line">	listing(mydir)									<span class="comment"># Self-test code: list myself</span></span><br></pre></td></tr></table></figure>

<p>定制版本的内置函数<code>dir</code>,定义了<code>listing</code>函数,这个函数以模块对象为参数,打印该模块命名空间的格式化列表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> mydir</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>help(mydir)</span><br><span class="line"></span><br><span class="line">Help on module mydir:</span><br><span class="line"></span><br><span class="line">NAME</span><br><span class="line">    mydir - mydir.py: a module that lists the namespaces of other modules</span><br><span class="line"></span><br><span class="line">FUNCTIONS</span><br><span class="line">    listing(module, verbose=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">DATA</span><br><span class="line">    sepchr = <span class="string">'-'</span></span><br><span class="line">    seplen = <span class="number">60</span></span><br><span class="line"></span><br><span class="line">FILE</span><br><span class="line">    /mydir.py</span><br></pre></td></tr></table></figure>

<p>可以通过<code>__doc__</code>属性或<code>help</code>函数访问功能性信息</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">python mydir</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">name: mydir file: /mydir.py</span><br><span class="line">------------------------------------------------------------</span><br><span class="line"><span class="number">00</span>) __name__ &lt;built-<span class="keyword">in</span> name&gt;</span><br><span class="line"><span class="number">01</span>) __doc__ &lt;built-<span class="keyword">in</span> name&gt;</span><br><span class="line"><span class="number">02</span>) __package__ &lt;built-<span class="keyword">in</span> name&gt;</span><br><span class="line"><span class="number">03</span>) __loader__ &lt;built-<span class="keyword">in</span> name&gt;</span><br><span class="line"><span class="number">04</span>) __spec__ &lt;built-<span class="keyword">in</span> name&gt;</span><br><span class="line"><span class="number">05</span>) __file__ &lt;built-<span class="keyword">in</span> name&gt;</span><br><span class="line"><span class="number">06</span>) __cached__ &lt;built-<span class="keyword">in</span> name&gt;</span><br><span class="line"><span class="number">07</span>) __builtins__ &lt;built-<span class="keyword">in</span> name&gt;</span><br><span class="line"><span class="number">08</span>) seplen <span class="number">60</span></span><br><span class="line"><span class="number">09</span>) sepchr -</span><br><span class="line"><span class="number">10</span>) listing &lt;function listing at <span class="number">0x1042056a8</span>&gt;</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">mydir has <span class="number">11</span> names</span><br><span class="line">------------------------------------------------------------</span><br></pre></td></tr></table></figure>

<p>导入并列出自己</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> mydir</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> tkinter</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>mydir.listing(tkinter)</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">name: tkinter file: /tkinter/__init__.py</span><br><span class="line">------------------------------------------------------------</span><br><span class="line"><span class="number">00</span>) __name__ &lt;built-<span class="keyword">in</span> name&gt;</span><br><span class="line"><span class="number">01</span>) __doc__ &lt;built-<span class="keyword">in</span> name&gt;</span><br><span class="line"><span class="number">02</span>) __package__ &lt;built-<span class="keyword">in</span> name&gt;</span><br><span class="line"><span class="number">03</span>) __loader__ &lt;built-<span class="keyword">in</span> name&gt;</span><br><span class="line"><span class="number">04</span>) __spec__ &lt;built-<span class="keyword">in</span> name&gt;</span><br><span class="line"><span class="number">05</span>) __path__ &lt;built-<span class="keyword">in</span> name&gt;</span><br><span class="line"><span class="number">06</span>) __file__ &lt;built-<span class="keyword">in</span> name&gt;</span><br><span class="line"><span class="number">07</span>) __cached__ &lt;built-<span class="keyword">in</span> name&gt;</span><br><span class="line"><span class="number">08</span>) __builtins__ &lt;built-<span class="keyword">in</span> name&gt;</span><br><span class="line"><span class="number">09</span>) enum &lt;module <span class="string">'enum'</span> <span class="keyword">from</span> <span class="string">'/enum.py'</span>&gt;</span><br><span class="line"><span class="number">10</span>) sys &lt;module <span class="string">'sys'</span> (built-<span class="keyword">in</span>)&gt;</span><br><span class="line"><span class="number">11</span>) _tkinter &lt;module <span class="string">'_tkinter'</span> <span class="keyword">from</span> <span class="string">'/lib-dynload/_tkinter.cpython-36m-darwin.so'</span>&gt;</span><br><span class="line"><span class="number">12</span>) TclError &lt;<span class="class"><span class="keyword">class</span> '<span class="title">_tkinter</span>.<span class="title">TclError</span>'&gt;</span></span><br><span class="line"><span class="class">13) <span class="title">constants</span> &lt;<span class="title">module</span> '<span class="title">tkinter</span>.<span class="title">constants</span>' <span class="title">from</span> '/<span class="title">constants</span>.<span class="title">py</span>'&gt;</span></span><br><span class="line"><span class="class">14) <span class="title">NO</span> 0</span></span><br><span class="line"><span class="class">15) <span class="title">FALSE</span> 0</span></span><br><span class="line"><span class="class">16) <span class="title">OFF</span> 0</span></span><br><span class="line"><span class="class">17) <span class="title">YES</span> 1</span></span><br><span class="line"><span class="class">18) <span class="title">TRUE</span> 1</span></span><br><span class="line"><span class="class">19) <span class="title">ON</span> 1</span></span><br><span class="line"><span class="class">20) <span class="title">N</span> <span class="title">n</span></span></span><br><span class="line"><span class="class">21) <span class="title">S</span> <span class="title">s</span></span></span><br><span class="line"><span class="class">22) <span class="title">W</span> <span class="title">w</span></span></span><br><span class="line"><span class="class">23) <span class="title">E</span> <span class="title">e</span></span></span><br><span class="line"><span class="class">24) <span class="title">NW</span> <span class="title">nw</span></span></span><br><span class="line"><span class="class">25) <span class="title">SW</span> <span class="title">sw</span></span></span><br><span class="line"><span class="class">26) <span class="title">NE</span> <span class="title">ne</span></span></span><br><span class="line"><span class="class">27) <span class="title">SE</span> <span class="title">se</span></span></span><br><span class="line"><span class="class">28) <span class="title">NS</span> <span class="title">ns</span></span></span><br><span class="line"><span class="class">29) <span class="title">EW</span> <span class="title">ew</span></span></span><br><span class="line"><span class="class">30) <span class="title">NSEW</span> <span class="title">nsew</span></span></span><br><span class="line"><span class="class">31) <span class="title">CENTER</span> <span class="title">center</span></span></span><br><span class="line"><span class="class">32) <span class="title">NONE</span> <span class="title">none</span></span></span><br><span class="line"><span class="class">33) <span class="title">X</span> <span class="title">x</span></span></span><br><span class="line"><span class="class">34) <span class="title">Y</span> <span class="title">y</span></span></span><br><span class="line"><span class="class">35) <span class="title">BOTH</span> <span class="title">both</span></span></span><br><span class="line"><span class="class">36) <span class="title">LEFT</span> <span class="title">left</span></span></span><br><span class="line"><span class="class">37) <span class="title">TOP</span> <span class="title">top</span></span></span><br><span class="line"><span class="class">38) <span class="title">RIGHT</span> <span class="title">right</span></span></span><br><span class="line"><span class="class">39) <span class="title">BOTTOM</span> <span class="title">bottom</span></span></span><br><span class="line"><span class="class">40) <span class="title">RAISED</span> <span class="title">raised</span></span></span><br><span class="line"><span class="class">41) <span class="title">SUNKEN</span> <span class="title">sunken</span></span></span><br><span class="line"><span class="class">42) <span class="title">FLAT</span> <span class="title">flat</span></span></span><br><span class="line"><span class="class">43) <span class="title">RIDGE</span> <span class="title">ridge</span></span></span><br><span class="line"><span class="class">44) <span class="title">GROOVE</span> <span class="title">groove</span></span></span><br><span class="line"><span class="class">45) <span class="title">SOLID</span> <span class="title">solid</span></span></span><br><span class="line"><span class="class">46) <span class="title">HORIZONTAL</span> <span class="title">horizontal</span></span></span><br><span class="line"><span class="class">47) <span class="title">VERTICAL</span> <span class="title">vertical</span></span></span><br><span class="line"><span class="class">48) <span class="title">NUMERIC</span> <span class="title">numeric</span></span></span><br><span class="line"><span class="class">49) <span class="title">CHAR</span> <span class="title">char</span></span></span><br><span class="line"><span class="class">50) <span class="title">WORD</span> <span class="title">word</span></span></span><br><span class="line"><span class="class">51) <span class="title">BASELINE</span> <span class="title">baseline</span></span></span><br><span class="line"><span class="class">52) <span class="title">INSIDE</span> <span class="title">inside</span></span></span><br><span class="line"><span class="class">53) <span class="title">OUTSIDE</span> <span class="title">outside</span></span></span><br><span class="line"><span class="class">54) <span class="title">SEL</span> <span class="title">sel</span></span></span><br><span class="line"><span class="class">55) <span class="title">SEL_FIRST</span> <span class="title">sel</span>.<span class="title">first</span></span></span><br><span class="line"><span class="class">56) <span class="title">SEL_LAST</span> <span class="title">sel</span>.<span class="title">last</span></span></span><br><span class="line"><span class="class">57) <span class="title">END</span> <span class="title">end</span></span></span><br><span class="line"><span class="class">58) <span class="title">INSERT</span> <span class="title">insert</span></span></span><br><span class="line"><span class="class">59) <span class="title">CURRENT</span> <span class="title">current</span></span></span><br><span class="line"><span class="class">60) <span class="title">ANCHOR</span> <span class="title">anchor</span></span></span><br><span class="line"><span class="class">61) <span class="title">ALL</span> <span class="title">all</span></span></span><br><span class="line"><span class="class">62) <span class="title">NORMAL</span> <span class="title">normal</span></span></span><br><span class="line"><span class="class">63) <span class="title">DISABLED</span> <span class="title">disabled</span></span></span><br><span class="line"><span class="class">64) <span class="title">ACTIVE</span> <span class="title">active</span></span></span><br><span class="line"><span class="class">65) <span class="title">HIDDEN</span> <span class="title">hidden</span></span></span><br><span class="line"><span class="class">66) <span class="title">CASCADE</span> <span class="title">cascade</span></span></span><br><span class="line"><span class="class">67) <span class="title">CHECKBUTTON</span> <span class="title">checkbutton</span></span></span><br><span class="line"><span class="class">68) <span class="title">COMMAND</span> <span class="title">command</span></span></span><br><span class="line"><span class="class">69) <span class="title">RADIOBUTTON</span> <span class="title">radiobutton</span></span></span><br><span class="line"><span class="class">70) <span class="title">SEPARATOR</span> <span class="title">separator</span></span></span><br><span class="line"><span class="class">71) <span class="title">SINGLE</span> <span class="title">single</span></span></span><br><span class="line"><span class="class">72) <span class="title">BROWSE</span> <span class="title">browse</span></span></span><br><span class="line"><span class="class">73) <span class="title">MULTIPLE</span> <span class="title">multiple</span></span></span><br><span class="line"><span class="class">74) <span class="title">EXTENDED</span> <span class="title">extended</span></span></span><br><span class="line"><span class="class">75) <span class="title">DOTBOX</span> <span class="title">dotbox</span></span></span><br><span class="line"><span class="class">76) <span class="title">UNDERLINE</span> <span class="title">underline</span></span></span><br><span class="line"><span class="class">77) <span class="title">PIESLICE</span> <span class="title">pieslice</span></span></span><br><span class="line"><span class="class">78) <span class="title">CHORD</span> <span class="title">chord</span></span></span><br><span class="line"><span class="class">79) <span class="title">ARC</span> <span class="title">arc</span></span></span><br><span class="line"><span class="class">80) <span class="title">FIRST</span> <span class="title">first</span></span></span><br><span class="line"><span class="class">81) <span class="title">LAST</span> <span class="title">last</span></span></span><br><span class="line"><span class="class">82) <span class="title">BUTT</span> <span class="title">butt</span></span></span><br><span class="line"><span class="class">83) <span class="title">PROJECTING</span> <span class="title">projecting</span></span></span><br><span class="line"><span class="class">84) <span class="title">ROUND</span> <span class="title">round</span></span></span><br><span class="line"><span class="class">85) <span class="title">BEVEL</span> <span class="title">bevel</span></span></span><br><span class="line"><span class="class">86) <span class="title">MITER</span> <span class="title">miter</span></span></span><br><span class="line"><span class="class">87) <span class="title">MOVETO</span> <span class="title">moveto</span></span></span><br><span class="line"><span class="class">88) <span class="title">SCROLL</span> <span class="title">scroll</span></span></span><br><span class="line"><span class="class">89) <span class="title">UNITS</span> <span class="title">units</span></span></span><br><span class="line"><span class="class">90) <span class="title">PAGES</span> <span class="title">pages</span></span></span><br><span class="line"><span class="class">91) <span class="title">re</span> &lt;<span class="title">module</span> '<span class="title">re</span>' <span class="title">from</span> '/<span class="title">re</span>.<span class="title">py</span>'&gt;</span></span><br><span class="line"><span class="class">92) <span class="title">wantobjects</span> 1</span></span><br><span class="line"><span class="class">93) <span class="title">TkVersion</span> 8.5</span></span><br><span class="line"><span class="class">94) <span class="title">TclVersion</span> 8.5</span></span><br><span class="line"><span class="class">95) <span class="title">READABLE</span> 2</span></span><br><span class="line"><span class="class">96) <span class="title">WRITABLE</span> 4</span></span><br><span class="line"><span class="class">97) <span class="title">EXCEPTION</span> 8</span></span><br><span class="line"><span class="class">98) <span class="title">_magic_re</span> <span class="title">re</span>.<span class="title">compile</span><span class="params">(<span class="string">'([\\\\&#123;&#125;])'</span>)</span></span></span><br><span class="line"><span class="class">99) <span class="title">_space_re</span> <span class="title">re</span>.<span class="title">compile</span><span class="params">(<span class="string">'([\\s])'</span>, re.ASCII)</span></span></span><br><span class="line"><span class="class">100) <span class="title">_join</span> &lt;<span class="title">function</span> <span class="title">_join</span> <span class="title">at</span> 0<span class="title">x104783400</span>&gt;</span></span><br><span class="line"><span class="class">101) <span class="title">_stringify</span> &lt;<span class="title">function</span> <span class="title">_stringify</span> <span class="title">at</span> 0<span class="title">x104783488</span>&gt;</span></span><br><span class="line"><span class="class">102) <span class="title">_flatten</span> &lt;<span class="title">built</span>-<span class="title">in</span> <span class="title">function</span> <span class="title">_flatten</span>&gt;</span></span><br><span class="line"><span class="class">103) <span class="title">_cnfmerge</span> &lt;<span class="title">function</span> <span class="title">_cnfmerge</span> <span class="title">at</span> 0<span class="title">x104783598</span>&gt;</span></span><br><span class="line"><span class="class">104) <span class="title">_splitdict</span> &lt;<span class="title">function</span> <span class="title">_splitdict</span> <span class="title">at</span> 0<span class="title">x104783620</span>&gt;</span></span><br><span class="line"><span class="class">105) <span class="title">EventType</span> &lt;<span class="title">enum</span> '<span class="title">EventType</span>'&gt;</span></span><br><span class="line"><span class="class">106) <span class="title">Event</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">Event</span>'&gt;</span></span><br><span class="line"><span class="class">107) <span class="title">_support_default_root</span> 1</span></span><br><span class="line"><span class="class">108) <span class="title">_default_root</span> <span class="title">None</span></span></span><br><span class="line"><span class="class">109) <span class="title">NoDefaultRoot</span> &lt;<span class="title">function</span> <span class="title">NoDefaultRoot</span> <span class="title">at</span> 0<span class="title">x1047836a8</span>&gt;</span></span><br><span class="line"><span class="class">110) <span class="title">_tkerror</span> &lt;<span class="title">function</span> <span class="title">_tkerror</span> <span class="title">at</span> 0<span class="title">x1047838c8</span>&gt;</span></span><br><span class="line"><span class="class">111) <span class="title">_exit</span> &lt;<span class="title">function</span> <span class="title">_exit</span> <span class="title">at</span> 0<span class="title">x104783950</span>&gt;</span></span><br><span class="line"><span class="class">112) <span class="title">_varnum</span> 0</span></span><br><span class="line"><span class="class">113) <span class="title">Variable</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">Variable</span>'&gt;</span></span><br><span class="line"><span class="class">114) <span class="title">StringVar</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">StringVar</span>'&gt;</span></span><br><span class="line"><span class="class">115) <span class="title">IntVar</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">IntVar</span>'&gt;</span></span><br><span class="line"><span class="class">116) <span class="title">DoubleVar</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">DoubleVar</span>'&gt;</span></span><br><span class="line"><span class="class">117) <span class="title">BooleanVar</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">BooleanVar</span>'&gt;</span></span><br><span class="line"><span class="class">118) <span class="title">mainloop</span> &lt;<span class="title">function</span> <span class="title">mainloop</span> <span class="title">at</span> 0<span class="title">x1047839d8</span>&gt;</span></span><br><span class="line"><span class="class">119) <span class="title">getint</span> &lt;<span class="title">class</span> '<span class="title">int</span>'&gt;</span></span><br><span class="line"><span class="class">120) <span class="title">getdouble</span> &lt;<span class="title">class</span> '<span class="title">float</span>'&gt;</span></span><br><span class="line"><span class="class">121) <span class="title">getboolean</span> &lt;<span class="title">function</span> <span class="title">getboolean</span> <span class="title">at</span> 0<span class="title">x1047b86a8</span>&gt;</span></span><br><span class="line"><span class="class">122) <span class="title">Misc</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">Misc</span>'&gt;</span></span><br><span class="line"><span class="class">123) <span class="title">CallWrapper</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">CallWrapper</span>'&gt;</span></span><br><span class="line"><span class="class">124) <span class="title">XView</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">XView</span>'&gt;</span></span><br><span class="line"><span class="class">125) <span class="title">YView</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">YView</span>'&gt;</span></span><br><span class="line"><span class="class">126) <span class="title">Wm</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">Wm</span>'&gt;</span></span><br><span class="line"><span class="class">127) <span class="title">Tk</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">Tk</span>'&gt;</span></span><br><span class="line"><span class="class">128) <span class="title">Tcl</span> &lt;<span class="title">function</span> <span class="title">Tcl</span> <span class="title">at</span> 0<span class="title">x1047b8730</span>&gt;</span></span><br><span class="line"><span class="class">129) <span class="title">Pack</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">Pack</span>'&gt;</span></span><br><span class="line"><span class="class">130) <span class="title">Place</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">Place</span>'&gt;</span></span><br><span class="line"><span class="class">131) <span class="title">Grid</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">Grid</span>'&gt;</span></span><br><span class="line"><span class="class">132) <span class="title">BaseWidget</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">BaseWidget</span>'&gt;</span></span><br><span class="line"><span class="class">133) <span class="title">Widget</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">Widget</span>'&gt;</span></span><br><span class="line"><span class="class">134) <span class="title">Toplevel</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">Toplevel</span>'&gt;</span></span><br><span class="line"><span class="class">135) <span class="title">Button</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">Button</span>'&gt;</span></span><br><span class="line"><span class="class">136) <span class="title">Canvas</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">Canvas</span>'&gt;</span></span><br><span class="line"><span class="class">137) <span class="title">Checkbutton</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">Checkbutton</span>'&gt;</span></span><br><span class="line"><span class="class">138) <span class="title">Entry</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">Entry</span>'&gt;</span></span><br><span class="line"><span class="class">139) <span class="title">Frame</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">Frame</span>'&gt;</span></span><br><span class="line"><span class="class">140) <span class="title">Label</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">Label</span>'&gt;</span></span><br><span class="line"><span class="class">141) <span class="title">Listbox</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">Listbox</span>'&gt;</span></span><br><span class="line"><span class="class">142) <span class="title">Menu</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">Menu</span>'&gt;</span></span><br><span class="line"><span class="class">143) <span class="title">Menubutton</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">Menubutton</span>'&gt;</span></span><br><span class="line"><span class="class">144) <span class="title">Message</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">Message</span>'&gt;</span></span><br><span class="line"><span class="class">145) <span class="title">Radiobutton</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">Radiobutton</span>'&gt;</span></span><br><span class="line"><span class="class">146) <span class="title">Scale</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">Scale</span>'&gt;</span></span><br><span class="line"><span class="class">147) <span class="title">Scrollbar</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">Scrollbar</span>'&gt;</span></span><br><span class="line"><span class="class">148) <span class="title">Text</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">Text</span>'&gt;</span></span><br><span class="line"><span class="class">149) <span class="title">_setit</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">_setit</span>'&gt;</span></span><br><span class="line"><span class="class">150) <span class="title">OptionMenu</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">OptionMenu</span>'&gt;</span></span><br><span class="line"><span class="class">151) <span class="title">Image</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">Image</span>'&gt;</span></span><br><span class="line"><span class="class">152) <span class="title">PhotoImage</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">PhotoImage</span>'&gt;</span></span><br><span class="line"><span class="class">153) <span class="title">BitmapImage</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">BitmapImage</span>'&gt;</span></span><br><span class="line"><span class="class">154) <span class="title">image_names</span> &lt;<span class="title">function</span> <span class="title">image_names</span> <span class="title">at</span> 0<span class="title">x1047c2268</span>&gt;</span></span><br><span class="line"><span class="class">155) <span class="title">image_types</span> &lt;<span class="title">function</span> <span class="title">image_types</span> <span class="title">at</span> 0<span class="title">x10f9c7510</span>&gt;</span></span><br><span class="line"><span class="class">156) <span class="title">Spinbox</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">Spinbox</span>'&gt;</span></span><br><span class="line"><span class="class">157) <span class="title">LabelFrame</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">LabelFrame</span>'&gt;</span></span><br><span class="line"><span class="class">158) <span class="title">PanedWindow</span> &lt;<span class="title">class</span> '<span class="title">tkinter</span>.<span class="title">PanedWindow</span>'&gt;</span></span><br><span class="line"><span class="class">159) <span class="title">_test</span> &lt;<span class="title">function</span> <span class="title">_test</span> <span class="title">at</span> 0<span class="title">x10f9c7598</span>&gt;</span></span><br><span class="line"><span class="class">------------------------------------------------------------</span></span><br><span class="line"><span class="class"><span class="title">tkinter</span> <span class="title">has</span> 160 <span class="title">names</span></span></span><br><span class="line"><span class="class">------------------------------------------------------------</span></span><br></pre></td></tr></table></figure>

<p>可以直接把模块作为对象传入到这个文件的函数中</p>
<hr>
<h2 id="用名称字符串导入模块"><a href="#用名称字符串导入模块" class="headerlink" title="用名称字符串导入模块"></a>用名称字符串导入模块</h2><p><code>import</code>语句中的名称既是引用载入模块对象的一个变量名,也从字面上标识了该外部对象</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> <span class="string">"string"</span></span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span></span><br><span class="line">    <span class="keyword">import</span> <span class="string">"string"</span></span><br><span class="line">                  ^</span><br><span class="line">SyntaxError: invalid syntax</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="string">"string"</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> x</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">ModuleNotFoundError: No module named <span class="string">'x'</span></span><br></pre></td></tr></table></figure>

<p><code>import</code>或<code>from</code>语句中的模块名是一个变量名称,无法载入以字符串形式给出的模块名</p>
<p>Python会尝试寻找变量名所对应的Python文件,而非变量名所引用的字符串对象</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>modname = <span class="string">"string"</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>exec(<span class="string">"import "</span> + modname)	<span class="comment"># Run a string of code</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>string						<span class="comment"># Imported in this namespace</span></span><br><span class="line">&lt;module <span class="string">'string'</span> <span class="keyword">from</span> <span class="string">'/string.py'</span>&gt;</span><br></pre></td></tr></table></figure>

<p>将<code>import</code>语句构建为一个字符串,并将其传递给<code>exec</code>内置函数可以动态加载一个模块</p>
<p><code>exec</code>函数及<code>eval</code>函数编译一个代码字符串,并将其传递给Python解释器执行</p>
<p><code>exec</code>默认运行当前当前作用域中的代码,可以通过传入可选的命名空间字典更加具体地应用</p>
<p><code>exec</code>每次运行时都需要编译<code>import</code>语句所以运行速度较慢</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>modname = <span class="string">"string"</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>string = __import__(modname)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>string</span><br><span class="line">&lt;module <span class="string">'string'</span> <span class="keyword">from</span> <span class="string">'/string.py'</span>&gt;</span><br></pre></td></tr></table></figure>

<p>内置<code>__import__</code>函数接受一个名称字符串并返回一个模块对象</p>
<hr>
<h2 id="过渡性模块重载"><a href="#过渡性模块重载" class="headerlink" title="过渡性模块重载"></a>过渡性模块重载</h2><p>重载可以修改程序代码而不需要停止或重新启动该程序</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># A.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> B		<span class="comment"># Not reloaded when A is</span></span><br><span class="line"><span class="keyword">import</span> C		<span class="comment"># Just an import of an already loaded module</span></span><br><span class="line"></span><br><span class="line">% python</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> A</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> imp <span class="keyword">import</span> reload</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>reload(A)</span><br></pre></td></tr></table></figure>

<p>Python重载传入的模块对象,模块对象中的导入语句若在此前已经运行则只会获取已经载入的模块对象</p>
<p>可以使用多次<code>reload</code>调用来独立地更新子部分或在父模块中添加<code>reload</code>调用自动重载</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">reloadall.py: transitively reload nested modules</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> types</span><br><span class="line"><span class="keyword">from</span> imp <span class="keyword">import</span> reload							<span class="comment"># from required in 3.0</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">status</span><span class="params">(module)</span>:</span></span><br><span class="line">	print(<span class="string">'reloading '</span> + module.__name__)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">transitive_reload</span><span class="params">(module, visited)</span>:</span></span><br><span class="line">	<span class="keyword">if</span> <span class="keyword">not</span> module <span class="keyword">in</span> visited:							<span class="comment"># Trap cycles,duplicates</span></span><br><span class="line">		status(module)									<span class="comment"># Reload this module</span></span><br><span class="line">		reload(module)									<span class="comment"># And visit children</span></span><br><span class="line">		visited[module] = <span class="literal">None</span></span><br><span class="line">		<span class="keyword">for</span> attrobj <span class="keyword">in</span> module.__dict__.values():		<span class="comment"># For all attrs</span></span><br><span class="line">			<span class="keyword">if</span> type(attrobj) == types.ModuleType:		<span class="comment"># Recur if module</span></span><br><span class="line">				transitive_reload(attrobj, visited)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reload_all</span><span class="params">(*args)</span>:</span></span><br><span class="line">	visited = &#123;&#125;</span><br><span class="line">	<span class="keyword">for</span> arg <span class="keyword">in</span> args:</span><br><span class="line">		<span class="keyword">if</span> type(arg) == types.ModuleType:</span><br><span class="line">			transitive_reload(arg, visited)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">	<span class="keyword">import</span> reloadall									<span class="comment"># Test code:reload myself</span></span><br><span class="line">	reload_all(reloadall)								<span class="comment"># Should reload this,types</span></span><br></pre></td></tr></table></figure>

<p>通过递归的扫描模块的<code>__dict__</code>属性并检查每一项的<code>type</code>找到要重载的嵌套模块</p>
<p><code>visited</code>用来在导入是递归或冗余的时候避免循环</p>
<p><code>types</code>模块直接为内置类型预定义<code>type</code>结果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">% python reloadall.py</span><br><span class="line">reloading reloadall</span><br><span class="line">reloading types</span><br><span class="line">reloading functools</span><br><span class="line">reloading collections.abc</span><br></pre></td></tr></table></figure>

<p>文件独立运行时,需要先导入自己,然后测试自己</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> reloadall <span class="keyword">import</span> reload_all</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> os, tkinter</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>reload_all(os)</span><br><span class="line">reloading os</span><br><span class="line">reloading abc</span><br><span class="line">reloading sys</span><br><span class="line">reloading errno</span><br><span class="line">reloading stat</span><br><span class="line">reloading posixpath</span><br><span class="line">reloading genericpath</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>reload_all(tkinter)</span><br><span class="line">reloading tkinter</span><br><span class="line">reloading enum</span><br><span class="line">reloading sys</span><br><span class="line">reloading _tkinter</span><br><span class="line">reloading tkinter.constants</span><br><span class="line">reloading re</span><br><span class="line">reloading sre_compile</span><br><span class="line">reloading _sre</span><br><span class="line">reloading sre_parse</span><br><span class="line">reloading functools</span><br><span class="line">reloading _locale</span><br><span class="line">reloading copyreg</span><br></pre></td></tr></table></figure>

<p>使用时导入<code>reload_all</code>并将一个已载入的模块的名称传递给它</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># a.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> b</span><br><span class="line">X = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># b.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> c</span><br><span class="line">Y = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># c.py</span></span><br><span class="line">Z = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">% python</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> a</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a.X, a.b.Y, a.b.c.Z</span><br><span class="line">(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#Change all three files' assignment values and save</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> impo <span class="keyword">import</span> reload</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>reload(a)					<span class="comment"># Normal reload is top level only</span></span><br><span class="line">&lt;module <span class="string">'a'</span> <span class="keyword">from</span> <span class="string">'/a.py'</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a.X, a.b.Y, a.b.c.Z</span><br><span class="line">(<span class="number">111</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">&gt;&gt; <span class="keyword">from</span> reloadall <span class="keyword">import</span> reload_all</span><br><span class="line">reload_all(a)</span><br><span class="line">reloading a</span><br><span class="line">reloading b</span><br><span class="line">reloading c</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a.X, a.b.Y, a.b.c.Z</span><br><span class="line">(<span class="number">111</span>, <span class="number">222</span>, <span class="number">333</span>)</span><br></pre></td></tr></table></figure>

<p>除非使用过渡性工具,否则重载不会对嵌套的导入文件进行修改</p>
<hr>
<h2 id="模块设计理念"><a href="#模块设计理念" class="headerlink" title="模块设计理念"></a>模块设计理念</h2><p>模块的操作环境包含变量、函数、类以及其他的模块，函数和类有自己的本地变量</p>
<p>模块设计方面的折中考虑:需要思考那些函数要放进模块、模块通信机制</p>
<p>模块的通用概念</p>
<blockquote>
<ul>
<li><p>总是在Python的模块内编写代码</p>
<p>没有办法写出不在某个模块之内的程序代码,在交互模式提示符下输入的程序代码其实是存在于内置模块<code>__main__</code>之内</p>
<p>交互模式提示符独特之处就在于程序是执行后就立刻丢弃,以及表达式结果是自动打印的</p>
</li>
<li><p>模块耦合要降到最低:全局变量</p>
<p>就像函数一样,如果编写成闭合的盒子,模块运行得最好</p>
<p>编写原则就是除了导入的函数和类,模块应该尽可能和其他模块的全局变量无关</p>
</li>
<li><p>最大化模块的黏合性:统一目标</p>
<p>可以通过最大化模块的黏合性来最小化模块的耦合性</p>
<p>如果模块的所有元素都享有共同的目的,就不太可能依赖外部的变量名</p>
</li>
<li><p>模块应该少去修改其他模块的变量</p>
<p>可以使用另一个模块定义的全局变量,但是修改另一个模块内的全局变量通常会出现设计问题</p>
<p>应该试着通过函数参数返回值这类机制去传递结果而不是进行跨模块的修改</p>
<p>被修改的模块中全局变量的值会变成依赖于其他文件内的赋值给全局变量的值,而模块会变得难以理解和再利用</p>
</li>
</ul>
</blockquote>
<hr>
<h2 id="模块陷阱"><a href="#模块陷阱" class="headerlink" title="模块陷阱"></a>模块陷阱</h2><blockquote>
<p>本节中，我们要看一看会让Python初学者生活多点乐趣的常见的极端案例</p>
</blockquote>
<h3 id="顶层代码的语句次序的重要性"><a href="#顶层代码的语句次序的重要性" class="headerlink" title="顶层代码的语句次序的重要性"></a>顶层代码的语句次序的重要性</h3><p>当模块首次导入或重载时,Python会从头到尾执行语句</p>
<p>作为原则,如果需要把立即执行的代码和<code>def</code>一起混用,就要把<code>def</code>放在文件前面,把顶层代码放在后面,保证代码运行时<code>def</code>已定义并赋值</p>
<p>前向引用相关含义</p>
<blockquote>
<ul>
<li>在导入时,模块文件顶层的程序代码(不在函数内)会在Python运行到时立刻执行,因此程序代码无法引用文件后面位置赋值的变量名</li>
<li>位于函数主体内的代码直到函数被调用后才会运行.因为函数内的变量名在函数实际执行前都不会解析,通常可以引用文件内<strong>任意地方</strong>的变量</li>
</ul>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">func1()					<span class="comment"># Error:"func1" not yet assigned</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func1</span><span class="params">()</span>:</span></span><br><span class="line">	print(func2())		<span class="comment"># Okay:"func2" looked up later</span></span><br><span class="line"></span><br><span class="line">func1()					<span class="comment"># Error:"func2" not yet assigned</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func2</span><span class="params">()</span>:</span></span><br><span class="line">	<span class="keyword">return</span> <span class="string">"Hello"</span></span><br><span class="line"></span><br><span class="line">func1()					<span class="comment"># Okay:"func1" and "func2" assigned</span></span><br></pre></td></tr></table></figure>

<p>一般来说,前向引用只对立即执行的顶层模块代码有影响,函数内可以任意引用变量名</p>
<h3 id="from赋值变量名-而不是连接"><a href="#from赋值变量名-而不是连接" class="headerlink" title="from赋值变量名,而不是连接"></a>from赋值变量名,而不是连接</h3><p><code>from</code>语句是在<strong>导入者的作用域内</strong>对变量名的赋值语句,也就是先对引用对象拷贝,再对拷贝的对象赋值,不会连接到模块中的变量名</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># nested1.py</span></span><br><span class="line">X = <span class="number">99</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printer</span><span class="params">()</span>:</span> print(X)</span><br><span class="line"></span><br><span class="line"><span class="comment"># nested2.py</span></span><br><span class="line"><span class="keyword">from</span> nested1 <span class="keyword">import</span> X, printer	<span class="comment"># Copy names out</span></span><br><span class="line">X = <span class="number">88</span> 							<span class="comment"># Changes my "X" only!</span></span><br><span class="line">printer()						<span class="comment"># nested1's X is still 99</span></span><br><span class="line"></span><br><span class="line">% python nested2.py</span><br><span class="line"><span class="number">99</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># nested3.py</span></span><br><span class="line"><span class="keyword">import</span> nested1					<span class="comment"># Get module as a whole</span></span><br><span class="line">nested1.X = <span class="number">88</span>					<span class="comment"># OK:change nested1's X</span></span><br><span class="line">nested1.printer()</span><br><span class="line"></span><br><span class="line">% python nested3.py</span><br><span class="line"><span class="number">99</span></span><br></pre></td></tr></table></figure>

<p>使用<code>from</code>导入模块属性,在导入者内修改变量名只会重设该变量名引用的本地作用域副本对象的绑定值</p>
<p>使用<code>import</code>获得整个模块,赋值<code>.</code>运算的变量名会修改被导入模块中的变量名</p>
<p><code>.</code>运算把Python定向到模块对象内的变量名而不是导入者的变量名</p>
<h3 id="from-会让变量语义模糊"><a href="#from-会让变量语义模糊" class="headerlink" title="from *会让变量语义模糊"></a>from *会让变量语义模糊</h3><p><code>from module import *</code>可能会意外覆盖作用域内已使用的变量,而且很难确认变量来自何处</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; from module1  import *		# Bad:may overwrite my names silently</span><br><span class="line">&gt;&gt;&gt; from module2  import *		# no way to tell what we get!</span><br><span class="line">&gt;&gt;&gt; from module2  import *</span><br><span class="line">&gt;&gt;&gt; ...</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; func()						# Huh?</span><br></pre></td></tr></table></figure>

<p>在三个模块上使用<code>from *</code>后就没有办法知道简单的函数调用真正含义,除非搜索这三个外部模块文件</p>
<p>解决的办法是不要这样做,应该在<code>from</code>语句中明确列出想要的属性,而且限制在每个文件中最多只有一个被导入的模块使用<code>from *</code>语句.这样未定义的变量一定来自<code>from *</code>所导入的模块</p>
<h3 id="reload不会影响from导入"><a href="#reload不会影响from导入" class="headerlink" title="reload不会影响from导入"></a>reload不会影响from导入</h3><p><code>from</code>在执行时会复制模块属性并赋值给变量名,所以不会连接到变量名的那个模块</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> module <span class="keyword">import</span> X		<span class="comment"># X may not reflect any module reloads!</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">from</span> imp <span class="keyword">import</span> relaod</span><br><span class="line">reload(module)				<span class="comment"># Changes module,but not my names</span></span><br><span class="line">X							<span class="comment"># Still references old object</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> module				<span class="comment"># Get module, not names</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">from</span> imp <span class="keyword">import</span> reload</span><br><span class="line">relaod(module)				<span class="comment"># Changes module in-place</span></span><br><span class="line">module.X					<span class="comment"># Get current X:reflects module reloads</span></span><br></pre></td></tr></table></figure>

<p>由于<code>from</code>语句的机制,重载被导入者对于使用<code>from</code>导入者的变量名没有影响</p>
<p>使用<code>import</code>语句及<code>.</code>运算会连接模块内的变量名,这样就会找到模块重载后变量名的新的绑定值</p>
<h3 id="reload、from以及交互模式测试"><a href="#reload、from以及交互模式测试" class="headerlink" title="reload、from以及交互模式测试"></a>reload、from以及交互模式测试</h3><p>通常不应该通过<code>reload</code>和<code>from</code>来启动程序,可以使用<code>reload</code>和<code>import</code> 或者其他方式启动程序</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> module <span class="keyword">import</span> function</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>function(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> impo <span class="keyword">import</span> reload</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>reload(module)</span><br></pre></td></tr></table></figure>

<p>启动一个交互模式会话,通过<code>from</code>加载并测试模块</p>
<p><code>from</code>语句赋值的是变量名<code>function</code>而不是<code>module</code>,重载是行不通的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">from imp import relaod</span><br><span class="line">import module</span><br><span class="line">relaod(module)</span><br><span class="line">from module import function		# Or give up adn use module.function()</span><br><span class="line">function(1, 2, 3)</span><br></pre></td></tr></table></figure>

<p>可以重新执行<code>from</code>语句或者使用<code>import</code>语句和<code>.</code>运算再重载</p>
<h3 id="递归形式的from导入无法工作"><a href="#递归形式的from导入无法工作" class="headerlink" title="递归形式的from导入无法工作"></a>递归形式的from导入无法工作</h3><p>导入会从头到尾执行一个文件的语句,但是使用相互导入的模块时需要十分小心,当被导入的模块递归导入导入者时Python会避免重新执行以防止死循环,所以导入者模块的命名空间此时还不完整,有些变量名可能还不存在</p>
<p>递归导入时使用<code>import</code>可以在在取出整个模块后稍后使用<code>.</code>运算读取还未赋值的变量名,使用<code>from</code>只能读取在模块中已经赋值的变量名</p>
<p>有两种方式避开这个陷阱</p>
<blockquote>
<ul>
<li>小心设计,通常可以避免这种导入循环:最大化模块的聚合性,同时最小化模块间的耦合性,是一个很好的开始</li>
<li>如果无法完全断开循环,就要使用<code>import</code>和<code>.</code>运算而不是<code>from</code>,将模块变量名的读取放在后边,要么就是在函数中,或者在文件末尾附近去执行<code>from</code>,以延迟其执行。</li>
</ul>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># recur1.py</span></span><br><span class="line">X = <span class="number">1</span></span><br><span class="line"><span class="keyword">import</span> recur2			<span class="comment"># Run recur2 now if it doesn't exist</span></span><br><span class="line">Y = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># recur2.py</span></span><br><span class="line"><span class="keyword">from</span> recur1 <span class="keyword">import</span> X	<span class="comment"># OK: "X" already assigned</span></span><br><span class="line"><span class="keyword">from</span> recur1 <span class="keyword">import</span> Y	<span class="comment"># Error:"Y" not  yet assigned</span></span><br><span class="line"></span><br><span class="line">% python</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> recur1</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">  File <span class="string">"/recur1.py"</span>, line <span class="number">2</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">    <span class="keyword">import</span> recur2</span><br><span class="line">  File <span class="string">"/recur2.py"</span>, line <span class="number">2</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">    <span class="keyword">from</span> recur1 <span class="keyword">import</span> Y</span><br><span class="line">ImportError: cannot <span class="keyword">import</span> name <span class="string">'Y'</span></span><br></pre></td></tr></table></figure>

<p><code>recur1</code>给变量名<code>X</code>赋值,然后在赋值变量名<code>Y</code>之前导入<code>recur2</code>,这时<code>recur2</code>可以用<code>import</code>把<code>recur1</code>整个取出,但是如果是用<code>from</code>只能看见变量名<code>X</code>,变量名<code>Y</code>是在导入<code>recur1</code>后赋值的,此时还不存在,所以会产生错误</p>
<hr>
<h2 id="本章习题-3"><a href="#本章习题-3" class="headerlink" title="本章习题"></a>本章习题</h2><ol>
<li><p>模块顶层以下划线开头的变量名的重要性是什么</p>
<blockquote>
<p>当使用<code>from *</code>语句形式导入时,以单个下划线开头的模块顶层变量名不会被复制到执行导入的作用域中</p>
<p>这类变量名可通过<code>import</code>或者普通的<code>from</code>语句形式来导入</p>
</blockquote>
</li>
<li><p>当模块的<code>__name__</code>变量是字符串<code>__main__</code>时, 代表了什么意义</p>
<blockquote>
<p>如果模块的<code>__name__</code>变量是字符串<code>__main__</code>,代表了该文件是作为顶层脚本运行的,而不是被另一个文件所导入的</p>
<p>也就是说,这个文件作为程序在使用,而不是一个库</p>
</blockquote>
</li>
<li><p>如果用户通过交互模式输入模块的变量名进行测试,该怎样进行导人</p>
<blockquote>
<p>用户输入脚本时通常作为字符串,要通过字符串类型的变量名导入所引用的模块,可以创建<code>import</code>语句并通过<code>exec</code>执行,或把字符串名传给<code>__ import__</code>函数进行调用</p>
</blockquote>
</li>
<li><p>改变<code>sys.path</code>和设置<code>PYTHONPATH</code>来修改模块搜索路径有什么不同</p>
<blockquote>
<p>修改<code>sys.path</code>只会影响一个正在运行的程序,是暂时的,当程序结束时,修改就会消失</p>
<p><code>PYTHONPATH</code>设置是存在于操作系统中的,机器上所有程序都会使用,而且对这些设置的修改在程序离开后还会保存</p>
</blockquote>
</li>
<li><p>如果模块<code>__future__</code>可以导入未来,那可以导入过去吗</p>
<blockquote>
<p>不行,无法在Python中导入过去</p>
<p>可以安装这门]语言的旧版本</p>
</blockquote>
</li>
</ol>

    </article>
    <!-- license  -->
    
        <div class="license-wrapper">
            <p>原文作者：<a href="http://abcdefghijklmnopqrst.xyz">骑麦兜看落日</a>
            <p>原文链接：<a href="http://abcdefghijklmnopqrst.xyz/2018/08/10/Code_Python学习手册_5/">http://abcdefghijklmnopqrst.xyz/2018/08/10/Code_Python学习手册_5/</a>
            <p>发表日期：<a href="http://abcdefghijklmnopqrst.xyz/2018/08/10/Code_Python学习手册_5/">August 10th 2018, 6:00:00 pm</a>
            <p>更新日期：<a href="http://abcdefghijklmnopqrst.xyz/2018/08/10/Code_Python学习手册_5/">August 13th 2018, 5:00:00 am</a>
            <p>版权声明：本文采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p>
        </div>
    
    <!-- paginator  -->
    <ul class="post-paginator">
        <li class="next">
            
                <div class="nextSlogan">Next Post</div>
                <a href= "/2018/08/13/WP_JarvisOJ/" title= "[WriteUp]JarvisOJ">
                    <div class="nextTitle">[WriteUp]JarvisOJ</div>
                </a>
            
        </li>
        <li class="previous">
            
                <div class="prevSlogan">Previous Post</div>
                <a href= "/2018/08/05/Code_Python学习手册_4/" title= "[Code]Python学习手册_第四部分_函数">
                    <div class="prevTitle">[Code]Python学习手册_第四部分_函数</div>
                </a>
            
        </li>
    </ul>
    <!-- 评论插件 -->
    <!-- 来必力City版安装代码 -->

    <div id="lv-container" data-id="city" data-uid= MTAyMC8zNzY1OS8xNDE5MA==>
        <script type="text/javascript">
            (function (d, s) {
                var j, e = d.getElementsByTagName(s)[0];
                if (typeof LivereTower === 'function') { return; }
                j = d.createElement(s);
                j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
                j.async = true;

                e.parentNode.insertBefore(j, e);
            })(document, 'script');
        </script>
        <noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
    </div>

<!-- City版安装代码已完成 -->
    
    
    <!-- partial('_partial/comment/changyan') -->
    <!--PC版-->


    
    

    <!-- 评论 -->
</main>
            <!-- profile -->
            
        </div>
        <footer class="footer footer-unloaded">
    <!-- social  -->
    
    <div class="social">
        
    
        
            
                <a href="mailto:qimaidoukanluori@qq.com" class="iconfont-archer email" title=email ></a>
            
        
    
        
            
                <a href="//github.com/qimaidoukanluori" class="iconfont-archer github" target="_blank" title=github></a>
            
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    

    </div>
    
    <!-- powered by Hexo  -->
    <div class="copyright">
        <span id="hexo-power">Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></span><span class="iconfont-archer power">&#xe635;</span><span id="theme-info">theme <a href="https://github.com/fi3ework/hexo-theme-archer" target="_blank">Archer</a></span>
    </div>
    <!-- 不蒜子  -->
    
    <div class="busuanzi-container">
    
     
    <span id="busuanzi_container_site_pv">到访的小伙伴: <span id="busuanzi_value_site_pv"></span>只 </span>
    
    </div>
    
</footer>
    </div>
    <!-- toc -->
    
    <div class="toc-wrapper" style=
    







top:30vh;

    >
        <div class="toc-catalog">
            <span class="iconfont-archer catalog-icon">&#xe613;</span><span>CATALOG</span>
        </div>
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#第二十一章-模块-宏伟蓝图"><span class="toc-number">1.</span> <span class="toc-text">第二十一章 模块:宏伟蓝图</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#为什么使用模块"><span class="toc-number">1.1.</span> <span class="toc-text">为什么使用模块</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Python程序架构"><span class="toc-number">1.2.</span> <span class="toc-text">Python程序架构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#如何组织一个程序"><span class="toc-number">1.2.1.</span> <span class="toc-text">如何组织一个程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#导入和属性"><span class="toc-number">1.2.2.</span> <span class="toc-text">导入和属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#标准库模块"><span class="toc-number">1.2.3.</span> <span class="toc-text">标准库模块</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#import如何工作"><span class="toc-number">1.3.</span> <span class="toc-text">import如何工作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#搜索"><span class="toc-number">1.3.1.</span> <span class="toc-text">搜索</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#编译-可选"><span class="toc-number">1.3.2.</span> <span class="toc-text">编译(可选)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#运行"><span class="toc-number">1.3.3.</span> <span class="toc-text">运行</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#模块搜索路径"><span class="toc-number">1.4.</span> <span class="toc-text">模块搜索路径</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#配置搜索路径"><span class="toc-number">1.4.1.</span> <span class="toc-text">配置搜索路径</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#搜索路径的变动"><span class="toc-number">1.4.2.</span> <span class="toc-text">搜索路径的变动</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sys-path"><span class="toc-number">1.4.3.</span> <span class="toc-text">sys.path</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#模块文件选择"><span class="toc-number">1.4.4.</span> <span class="toc-text">模块文件选择</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#高级的模块选择概念"><span class="toc-number">1.4.5.</span> <span class="toc-text">高级的模块选择概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#第三方工具-distutils"><span class="toc-number">1.4.6.</span> <span class="toc-text">第三方工具:distutils</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#本章习题"><span class="toc-number">1.5.</span> <span class="toc-text">本章习题</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第二十二章-模块代码编写基础"><span class="toc-number">2.</span> <span class="toc-text">第二十二章 模块代码编写基础</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#模块的创建"><span class="toc-number">2.1.</span> <span class="toc-text">模块的创建</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#模块的使用"><span class="toc-number">2.2.</span> <span class="toc-text">模块的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#import语句"><span class="toc-number">2.2.1.</span> <span class="toc-text">import语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#from语句"><span class="toc-number">2.2.2.</span> <span class="toc-text">from语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#from-语句"><span class="toc-number">2.2.3.</span> <span class="toc-text">from *语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#导入只发生一次"><span class="toc-number">2.2.4.</span> <span class="toc-text">导入只发生一次</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#import和from是赋值语句"><span class="toc-number">2.2.5.</span> <span class="toc-text">import和from是赋值语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#文件间变量名的改变"><span class="toc-number">2.2.6.</span> <span class="toc-text">文件间变量名的改变</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#import和from的对等性"><span class="toc-number">2.2.7.</span> <span class="toc-text">import和from的对等性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#from语句潜在的陷阱"><span class="toc-number">2.2.8.</span> <span class="toc-text">from语句潜在的陷阱</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#何时使用import"><span class="toc-number">2.2.8.1.</span> <span class="toc-text">何时使用import</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#模块命名空间"><span class="toc-number">2.3.</span> <span class="toc-text">模块命名空间</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#文件生成命名空间"><span class="toc-number">2.3.1.</span> <span class="toc-text">文件生成命名空间</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#属性名的点号运算"><span class="toc-number">2.3.2.</span> <span class="toc-text">属性名的点号运算</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#导入和作用域"><span class="toc-number">2.3.3.</span> <span class="toc-text">导入和作用域</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#命名空间的嵌套"><span class="toc-number">2.3.4.</span> <span class="toc-text">命名空间的嵌套</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#重载模块"><span class="toc-number">2.4.</span> <span class="toc-text">重载模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#reload基础"><span class="toc-number">2.4.1.</span> <span class="toc-text">reload基础</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#reload实例"><span class="toc-number">2.4.2.</span> <span class="toc-text">reload实例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#为什么要在意-模块重载"><span class="toc-number">2.4.3.</span> <span class="toc-text">为什么要在意:模块重载</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#本章习题-1"><span class="toc-number">2.5.</span> <span class="toc-text">本章习题</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第二十三章-模块包"><span class="toc-number">3.</span> <span class="toc-text">第二十三章 模块包</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#包导入基础"><span class="toc-number">3.1.</span> <span class="toc-text">包导入基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#包和搜索路径设置"><span class="toc-number">3.1.1.</span> <span class="toc-text">包和搜索路径设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#init-py包文件"><span class="toc-number">3.1.2.</span> <span class="toc-text">__init__.py包文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#包导入实例"><span class="toc-number">3.2.</span> <span class="toc-text">包导入实例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#包对应的from语句和import语句"><span class="toc-number">3.2.1.</span> <span class="toc-text">包对应的from语句和import语句</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#为什么要使用包导入"><span class="toc-number">3.3.</span> <span class="toc-text">为什么要使用包导入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#三个系统的传说"><span class="toc-number">3.3.1.</span> <span class="toc-text">三个系统的传说</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#包相对导入"><span class="toc-number">3.4.</span> <span class="toc-text">包相对导入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Python-3-0中的变化"><span class="toc-number">3.4.1.</span> <span class="toc-text">Python 3.0中的变化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#相对导入基础知识"><span class="toc-number">3.4.2.</span> <span class="toc-text">相对导入基础知识</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#为什么使用相对导入"><span class="toc-number">3.4.3.</span> <span class="toc-text">为什么使用相对导入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Python-3-0中的相对导入解决方案"><span class="toc-number">3.4.3.1.</span> <span class="toc-text">Python 3.0中的相对导入解决方案</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#相对导入的作用域"><span class="toc-number">3.4.4.</span> <span class="toc-text">相对导入的作用域</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#模块查找规则总结"><span class="toc-number">3.4.5.</span> <span class="toc-text">模块查找规则总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#相对导入的应用"><span class="toc-number">3.4.6.</span> <span class="toc-text">相对导入的应用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#为什么要在意-模块包"><span class="toc-number">3.4.7.</span> <span class="toc-text">为什么要在意:模块包</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#本章习题-2"><span class="toc-number">3.5.</span> <span class="toc-text">本章习题</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第二十四章-高级模块话题"><span class="toc-number">4.</span> <span class="toc-text">第二十四章 高级模块话题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#在模块中隐藏数据"><span class="toc-number">4.1.</span> <span class="toc-text">在模块中隐藏数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#最小化from-的破坏-X和-all"><span class="toc-number">4.1.1.</span> <span class="toc-text">最小化from *的破坏:_X和__all__</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#启用以后的语言特性"><span class="toc-number">4.2.</span> <span class="toc-text">启用以后的语言特性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#混合用法模式-name-和-main"><span class="toc-number">4.3.</span> <span class="toc-text">混合用法模式:__name__和__main__</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#以-name-进行单元测试"><span class="toc-number">4.3.1.</span> <span class="toc-text">以__name__进行单元测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用带有-name-的命令行参数"><span class="toc-number">4.3.2.</span> <span class="toc-text">使用带有__name__的命令行参数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#修改模块搜索路径"><span class="toc-number">4.4.</span> <span class="toc-text">修改模块搜索路径</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Import语句和from语句的as拓展"><span class="toc-number">4.5.</span> <span class="toc-text">Import语句和from语句的as拓展</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#模块是对象-元程序"><span class="toc-number">4.6.</span> <span class="toc-text">模块是对象:元程序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#用名称字符串导入模块"><span class="toc-number">4.7.</span> <span class="toc-text">用名称字符串导入模块</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#过渡性模块重载"><span class="toc-number">4.8.</span> <span class="toc-text">过渡性模块重载</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#模块设计理念"><span class="toc-number">4.9.</span> <span class="toc-text">模块设计理念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#模块陷阱"><span class="toc-number">4.10.</span> <span class="toc-text">模块陷阱</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#顶层代码的语句次序的重要性"><span class="toc-number">4.10.1.</span> <span class="toc-text">顶层代码的语句次序的重要性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#from赋值变量名-而不是连接"><span class="toc-number">4.10.2.</span> <span class="toc-text">from赋值变量名,而不是连接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#from-会让变量语义模糊"><span class="toc-number">4.10.3.</span> <span class="toc-text">from *会让变量语义模糊</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#reload不会影响from导入"><span class="toc-number">4.10.4.</span> <span class="toc-text">reload不会影响from导入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#reload、from以及交互模式测试"><span class="toc-number">4.10.5.</span> <span class="toc-text">reload、from以及交互模式测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#递归形式的from导入无法工作"><span class="toc-number">4.10.6.</span> <span class="toc-text">递归形式的from导入无法工作</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#本章习题-3"><span class="toc-number">4.11.</span> <span class="toc-text">本章习题</span></a></li></ol></li></ol>
    </div>
    
    <div class="back-top iconfont-archer">&#xe639;</div>
    <div class="sidebar sidebar-hide">
    <ul class="sidebar-tabs sidebar-tabs-active-0">
        <li class="sidebar-tab-archives"><span class="iconfont-archer">&#xe67d;</span><span class="tab-name">Archive</span></li>
        <li class="sidebar-tab-tags"><span class="iconfont-archer">&#xe61b;</span><span class="tab-name">Tag</span></li>
        <li class="sidebar-tab-categories"><span class="iconfont-archer">&#xe666;</span><span class="tab-name">Cate</span></li>
    </ul>
    <div class="sidebar-content sidebar-content-show-archive">
          <div class="sidebar-panel-archives">
    <!-- 在ejs中将archive按照时间排序 -->
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <div class="total-and-search">
        <div class="total-archive">
        Total : 49
        </div>
        <!-- search  -->
        
            <div class="site-search popup-trigger">
                <span class="iconfont-archer search-icon">&#xe627;</span>
            </div>
        
    </div>
    
    <div class="post-archive">
    
    
    
    
    <div class="archive-year"> 2019 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/30</span><a class="archive-post-title" href= "/2019/10/30/Binary_Unicorn学习/" >[Binary]Unicorn学习</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/10</span><a class="archive-post-title" href= "/2019/09/10/WP_2019ByteCTF/" >[WriteUp]2019ByteCTF</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/26</span><a class="archive-post-title" href= "/2019/08/26/WP_2019OGeek/" >[WriteUp]2019OGeek</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/31</span><a class="archive-post-title" href= "/2019/07/31/WP_2019CISCN final/" >[WriteUp]2019CISCN final</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/07</span><a class="archive-post-title" href= "/2019/07/07/WP_2019WCTF/" >[WriteUp]2019WCTF</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/02</span><a class="archive-post-title" href= "/2019/07/02/Asm_WASM格式化字符串攻击尝试/" >[Asm]WASM格式化字符串攻击尝试</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/22</span><a class="archive-post-title" href= "/2019/01/22/Code_Python可变类型的一些问题/" >[Code]Python可变类型的一些问题</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/13</span><a class="archive-post-title" href= "/2019/01/13/Asm_WASM初步/" >[Asm]WASM初步</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2018 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/20</span><a class="archive-post-title" href= "/2018/12/20/Binary_通过a的leak/" >[Binary]通过%a的leak</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/07</span><a class="archive-post-title" href= "/2018/12/07/WP_hxpCTF/" >[WriteUp]hxpCTF</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/27</span><a class="archive-post-title" href= "/2018/11/27/WP_2018BCTF/" >[WriteUp]2018BCTF</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/14</span><a class="archive-post-title" href= "/2018/11/14/Binary_IO_FILE源码分析/" >[Binary]IO_FILE</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/05</span><a class="archive-post-title" href= "/2018/11/05/Binary_ArmPwn/" >[Asm]ARMPwn</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/04</span><a class="archive-post-title" href= "/2018/11/04/WP_上海杯/" >[WriteUp]上海杯</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/27</span><a class="archive-post-title" href= "/2018/10/27/WP_HCTF/" >[WriteUp]HCTF</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/27</span><a class="archive-post-title" href= "/2018/10/27/WP_湖湘杯/" >[WriteUp]湖湘杯</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/27</span><a class="archive-post-title" href= "/2018/10/27/WP_SECCONCTF/" >[WriteUp]SECCONCTF</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/24</span><a class="archive-post-title" href= "/2018/10/24/Binary_Tcache/" >[Binary]Tcache</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/17</span><a class="archive-post-title" href= "/2018/10/17/Asm_RealmodeAsm/" >[Asm]RealmodeAsm</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/13</span><a class="archive-post-title" href= "/2018/10/13/WP_2018护网杯/" >[WriteUp]护网杯</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/06</span><a class="archive-post-title" href= "/2018/10/06/Binary_IDADynamic/" >[Binary]IDADynamic</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/05</span><a class="archive-post-title" href= "/2018/10/05/Linux_pwn环境搭建/" >[Linux]pwn环境搭建</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/05</span><a class="archive-post-title" href= "/2018/10/05/WP_DragonCTF/" >[WriteUp]DefCampCTF</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/05</span><a class="archive-post-title" href= "/2018/10/05/WP_InCTF/" >[WriteUp]InCTF</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/28</span><a class="archive-post-title" href= "/2018/09/28/Binary_PDF/" >[Binary]PDF</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/27</span><a class="archive-post-title" href= "/2018/09/27/Linux_GDB的python调试/" >[Linux]GDB的Python调试</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/27</span><a class="archive-post-title" href= "/2018/09/27/Linux_GDB/" >[Linux]GDB</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/25</span><a class="archive-post-title" href= "/2018/09/25/WP_DefCampCTF/" >[WriteUp]DefCampCTF</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/18</span><a class="archive-post-title" href= "/2018/09/18/Android_JNI/" >[Android]JNI</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/18</span><a class="archive-post-title" href= "/2018/09/18/BInary_HeapExploit/" >[Binary]HeapExploit</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/13</span><a class="archive-post-title" href= "/2018/09/13/Binary_IO_FILE/" >[Binary]IO_FILE</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/10</span><a class="archive-post-title" href= "/2018/09/10/Linux_GDB的源码调试/" >[Linux]GDB源码调试</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/01</span><a class="archive-post-title" href= "/2018/09/01/Binary_ptmalloc源码分析/" >[Binary]ptmalloc源码分析</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/25</span><a class="archive-post-title" href= "/2018/08/25/WP_pwnable.tw/" >[WriteUp]pwnable.tw</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/21</span><a class="archive-post-title" href= "/2018/08/21/Code_Python学习手册_7/" >[Code]Python学习手册_第七部分_异常和工具</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/21</span><a class="archive-post-title" href= "/2018/08/21/WP_网鼎杯/" >[WriteUp]网鼎杯</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/14</span><a class="archive-post-title" href= "/2018/08/14/Code_Python学习手册_6/" >[Code]Python学习手册_第六部分_类和OOP</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/13</span><a class="archive-post-title" href= "/2018/08/13/WP_JarvisOJ/" >[WriteUp]JarvisOJ</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/10</span><a class="archive-post-title" href= "/2018/08/10/Code_Python学习手册_5/" >[Code]Python学习手册_第五部分_模块</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/05</span><a class="archive-post-title" href= "/2018/08/05/Code_Python学习手册_4/" >[Code]Python学习手册_第四部分_函数</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/05</span><a class="archive-post-title" href= "/2018/08/05/Binary_Heap/" >[Binary]Heap</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/30</span><a class="archive-post-title" href= "/2018/07/30/Linux_INT80/" >[Linux]int 80</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/30</span><a class="archive-post-title" href= "/2018/07/30/Code_Python学习手册_3/" >[Code]Python学习手册_第三部分_语句和语法</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/25</span><a class="archive-post-title" href= "/2018/07/25/Binary_Canary/" >[Binary]Canary</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/24</span><a class="archive-post-title" href= "/2018/07/24/Code_Python学习手册_2/" >[Code]Python学习手册_第二部分_类型和运算</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/22</span><a class="archive-post-title" href= "/2018/07/22/Binary_fmt/" >[Binary]FormatString</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/21</span><a class="archive-post-title" href= "/2018/07/21/Code_Python学习手册_1/" >[Code]Python学习手册_第一部分_使用入门</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/21</span><a class="archive-post-title" href= "/2018/07/21/WP_巅峰极客/" >[WriteUp]巅峰极客</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/22</span><a class="archive-post-title" href= "/2018/01/22/Code_Python的C拓展/" >[Code]Python的C拓展</a>
        </li>
    
    </div>
  </div>
        <div class="sidebar-panel-tags">
    <div class="sidebar-tags-name">
    
        <span class="sidebar-tag-name" data-tags="Note"><span class="iconfont-archer">&#xe606;</span>Note</span>
    
        <span class="sidebar-tag-name" data-tags="Assembly"><span class="iconfont-archer">&#xe606;</span>Assembly</span>
    
        <span class="sidebar-tag-name" data-tags="WASM"><span class="iconfont-archer">&#xe606;</span>WASM</span>
    
        <span class="sidebar-tag-name" data-tags="Binary"><span class="iconfont-archer">&#xe606;</span>Binary</span>
    
        <span class="sidebar-tag-name" data-tags="IDA"><span class="iconfont-archer">&#xe606;</span>IDA</span>
    
        <span class="sidebar-tag-name" data-tags="Linux"><span class="iconfont-archer">&#xe606;</span>Linux</span>
    
        <span class="sidebar-tag-name" data-tags="Asm"><span class="iconfont-archer">&#xe606;</span>Asm</span>
    
        <span class="sidebar-tag-name" data-tags="Android"><span class="iconfont-archer">&#xe606;</span>Android</span>
    
        <span class="sidebar-tag-name" data-tags="Pwn"><span class="iconfont-archer">&#xe606;</span>Pwn</span>
    
        <span class="sidebar-tag-name" data-tags="Canary"><span class="iconfont-archer">&#xe606;</span>Canary</span>
    
        <span class="sidebar-tag-name" data-tags="Heap"><span class="iconfont-archer">&#xe606;</span>Heap</span>
    
        <span class="sidebar-tag-name" data-tags="PDF"><span class="iconfont-archer">&#xe606;</span>PDF</span>
    
        <span class="sidebar-tag-name" data-tags="Tcache"><span class="iconfont-archer">&#xe606;</span>Tcache</span>
    
        <span class="sidebar-tag-name" data-tags="Code"><span class="iconfont-archer">&#xe606;</span>Code</span>
    
        <span class="sidebar-tag-name" data-tags="Python"><span class="iconfont-archer">&#xe606;</span>Python</span>
    
        <span class="sidebar-tag-name" data-tags="GDB"><span class="iconfont-archer">&#xe606;</span>GDB</span>
    
        <span class="sidebar-tag-name" data-tags="Pwntools"><span class="iconfont-archer">&#xe606;</span>Pwntools</span>
    
        <span class="sidebar-tag-name" data-tags="Qemu"><span class="iconfont-archer">&#xe606;</span>Qemu</span>
    
        <span class="sidebar-tag-name" data-tags="Gdb"><span class="iconfont-archer">&#xe606;</span>Gdb</span>
    
        <span class="sidebar-tag-name" data-tags="CTF"><span class="iconfont-archer">&#xe606;</span>CTF</span>
    
        <span class="sidebar-tag-name" data-tags="WriteUp"><span class="iconfont-archer">&#xe606;</span>WriteUp</span>
    
        <span class="sidebar-tag-name" data-tags="Re"><span class="iconfont-archer">&#xe606;</span>Re</span>
    
        <span class="sidebar-tag-name" data-tags="CTFtime"><span class="iconfont-archer">&#xe606;</span>CTFtime</span>
    
        <span class="sidebar-tag-name" data-tags="IO_FILE"><span class="iconfont-archer">&#xe606;</span>IO_FILE</span>
    
        <span class="sidebar-tag-name" data-tags="StackOverflow"><span class="iconfont-archer">&#xe606;</span>StackOverflow</span>
    
        <span class="sidebar-tag-name" data-tags="Arm"><span class="iconfont-archer">&#xe606;</span>Arm</span>
    
        <span class="sidebar-tag-name" data-tags="Cpp"><span class="iconfont-archer">&#xe606;</span>Cpp</span>
    
        <span class="sidebar-tag-name" data-tags="Java"><span class="iconfont-archer">&#xe606;</span>Java</span>
    
        <span class="sidebar-tag-name" data-tags="JNI"><span class="iconfont-archer">&#xe606;</span>JNI</span>
    
        <span class="sidebar-tag-name" data-tags="Unicorn"><span class="iconfont-archer">&#xe606;</span>Unicorn</span>
    
        <span class="sidebar-tag-name" data-tags="Fmt"><span class="iconfont-archer">&#xe606;</span>Fmt</span>
    
        <span class="sidebar-tag-name" data-tags="IntegerOverflow"><span class="iconfont-archer">&#xe606;</span>IntegerOverflow</span>
    
        <span class="sidebar-tag-name" data-tags="Cfunc"><span class="iconfont-archer">&#xe606;</span>Cfunc</span>
    
        <span class="sidebar-tag-name" data-tags="HouseOfRoman"><span class="iconfont-archer">&#xe606;</span>HouseOfRoman</span>
    
        <span class="sidebar-tag-name" data-tags="ShellCode"><span class="iconfont-archer">&#xe606;</span>ShellCode</span>
    
        <span class="sidebar-tag-name" data-tags="FastbinAttack"><span class="iconfont-archer">&#xe606;</span>FastbinAttack</span>
    
        <span class="sidebar-tag-name" data-tags="HeapOverflow"><span class="iconfont-archer">&#xe606;</span>HeapOverflow</span>
    
        <span class="sidebar-tag-name" data-tags="StackOvrtflow"><span class="iconfont-archer">&#xe606;</span>StackOvrtflow</span>
    
        <span class="sidebar-tag-name" data-tags="wargame"><span class="iconfont-archer">&#xe606;</span>wargame</span>
    
        <span class="sidebar-tag-name" data-tags="SystemCall"><span class="iconfont-archer">&#xe606;</span>SystemCall</span>
    
        <span class="sidebar-tag-name" data-tags="XCTF"><span class="iconfont-archer">&#xe606;</span>XCTF</span>
    
        <span class="sidebar-tag-name" data-tags="Fastbin"><span class="iconfont-archer">&#xe606;</span>Fastbin</span>
    
        <span class="sidebar-tag-name" data-tags="FormatString"><span class="iconfont-archer">&#xe606;</span>FormatString</span>
    
        <span class="sidebar-tag-name" data-tags="prctl"><span class="iconfont-archer">&#xe606;</span>prctl</span>
    
        <span class="sidebar-tag-name" data-tags="global_max_fast"><span class="iconfont-archer">&#xe606;</span>global_max_fast</span>
    
        <span class="sidebar-tag-name" data-tags="read"><span class="iconfont-archer">&#xe606;</span>read</span>
    
        <span class="sidebar-tag-name" data-tags="UAF"><span class="iconfont-archer">&#xe606;</span>UAF</span>
    
        <span class="sidebar-tag-name" data-tags="OJ"><span class="iconfont-archer">&#xe606;</span>OJ</span>
    
    </div>
    <div class="iconfont-archer sidebar-tags-empty">&#xe678;</div>
    <div class="tag-load-fail" style="display: none; color: #ccc; font-size: 0.6rem;">
    缺失模块。<br/>
    1、请确保node版本大于6.2<br/>
    2、在博客根目录（注意不是archer根目录）执行以下命令：<br/>
    <span style="color: #f75357; font-size: 1rem; line-height: 2rem;">npm i hexo-generator-json-content --save</span><br/>
    3、在根目录_config.yml里添加配置：
    <pre style="color: #787878; font-size: 0.6rem;">
jsonContent:
  meta: false
  pages: false
  posts:
    title: true
    date: true
    path: true
    text: false
    raw: false
    content: false
    slug: false
    updated: false
    comments: false
    link: false
    permalink: false
    excerpt: false
    categories: true
    tags: true</pre>
    </div> 
    <div class="sidebar-tags-list"></div>
</div>
        <div class="sidebar-panel-categories">
    <div class="sidebar-categories-name">
    
        <span class="sidebar-category-name" data-categories="Assembly"><span class="iconfont-archer">&#xe60a;</span>Assembly</span>
    
        <span class="sidebar-category-name" data-categories="Binary"><span class="iconfont-archer">&#xe60a;</span>Binary</span>
    
        <span class="sidebar-category-name" data-categories="Code"><span class="iconfont-archer">&#xe60a;</span>Code</span>
    
        <span class="sidebar-category-name" data-categories="Linux"><span class="iconfont-archer">&#xe60a;</span>Linux</span>
    
        <span class="sidebar-category-name" data-categories="WriteUp"><span class="iconfont-archer">&#xe60a;</span>WriteUp</span>
    
    </div>
    <div class="iconfont-archer sidebar-categories-empty">&#xe678;</div>
    <div class="sidebar-categories-list"></div>
</div>
    </div>
</div> 
    <script>
    var siteMeta = {
        root: "/",
        author: "骑麦兜看落日"
    }
</script>
    <!-- CDN failover -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
    <script type="text/javascript">
        if (typeof window.$ === 'undefined')
        {
            console.warn('jquery load from jsdelivr failed, will load local script')
            document.write('<script src="/lib/jquery.min.js">\x3C/script>')
        }
    </script>
    <script src="/scripts/main.js"></script>
    <!-- algolia -->
    
        <div class="site-search">
  <div class="algolia-popup popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="iconfont-archer">&#xe609;</i>
    </span>
  </div>
</div>
        <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.8.0/dist/instantsearch.min.js" defer></script>
        <script src="/scripts/search.js" defer></script>
    
    <!-- busuanzi  -->
    
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    <!-- CNZZ  -->
    
    </div>
    <!-- async load share.js -->
    
        <script src="/scripts/share.js" async></script>    
     
    </body>
</html>


